System.register("chunks:///_virtual/APIHandler.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,r;return{setters:[function(t){n=t.asyncToGenerator,e=t.regeneratorRuntime},function(t){r=t.cclegacy}],execute:function(){r._RF.push({},"b70cbqzva9DQIVa/fc77ZRD","APIHandler",void 0),t("APIHandler",function(){function t(){}t.instance=function(){return t._instance||(t._instance=new t),t._instance};var r=t.prototype;return r.get=function(){var t=n(e().mark((function t(n){var r;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(n,{method:"GET",mode:"no-cors",headers:{"Content-Type":"application/json"}});case 3:if(200!=(r=t.sent).status){t.next=8;break}return t.abrupt("return",r);case 8:return console.log("GET fail will status: ",r.status),t.abrupt("return",null);case 10:t.next=16;break;case 12:return t.prev=12,t.t0=t.catch(0),console.log("Error GET data: ",t.t0),t.abrupt("return",null);case 16:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(n){return t.apply(this,arguments)}}(),r.post=function(){var t=n(e().mark((function t(n,r){var a,u;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 3:if(200!=(a=t.sent).status){t.next=9;break}return u=a.json(),t.abrupt("return",u);case 9:console.log("POST fail with status: ",a.status);case 10:return t.abrupt("return",null);case 13:return t.prev=13,t.t0=t.catch(0),console.log("Error POST data: ",t.t0),t.abrupt("return",null);case 17:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(n,e){return t.apply(this,arguments)}}(),t}())._instance=void 0,r._RF.pop()}}}));

System.register("chunks:///_virtual/BasePopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Define.ts"],(function(t){var n,e,i,l,r,o,u,c,a,s,f;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,i=t.initializerDefineProperty,l=t.assertThisInitialized},function(t){r=t.cclegacy,o=t._decorator,u=t.Enum,c=t.Label,a=t.Button,s=t.Component},function(t){f=t.PopupName}],execute:function(){var p,h,B,g,b,y,d,v,m,z,k,x,T,C,F,w,P,R,L;r._RF.push({},"565bblJgQVCoJO+3m96zkzM","BasePopup",void 0);var D=o.ccclass,_=o.property;t("BasePopup",(p=D("BasePopup"),h=_({type:u(f)}),B=_(c),g=_(c),b=_(a),y=_(a),d=_(a),v=_(c),m=_(c),p((x=n((k=function(t){function n(){for(var n,e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return n=t.call.apply(t,[this].concat(r))||this,i(n,"type",x,l(n)),i(n,"title",T,l(n)),i(n,"content",C,l(n)),i(n,"closeBtn",F,l(n)),i(n,"leftBtn",w,l(n)),i(n,"rightBtn",P,l(n)),i(n,"leftBtnText",R,l(n)),i(n,"rightBtnText",L,l(n)),n.leftBtnFunc=function(){},n.rightBtnFunc=function(){},n}e(n,t);var r=n.prototype;return r.setup=function(t){this.title.string=t.title,this.content.string=t.content,this.leftBtnFunc=null==t?void 0:t.leftBtnFunction,this.rightBtnFunc=null==t?void 0:t.rightBtnFunction,this.leftBtnText.string=null==t?void 0:t.leftBtnText,this.rightBtnText.string=t.rightBtnText,this.leftBtn.node.active=null!=(null==t?void 0:t.leftBtnText),this.rightBtn.node.active=null!=t.rightBtnText},r.start=function(){this.closeBtn.node.on("click",this.onCloseBtnClick,this),this.leftBtn.node.on("click",this.onLeftBtnClick,this),this.rightBtn.node.on("click",this.onRighBtnClick,this)},r.update=function(t){},r.onCloseBtnClick=function(){this.node.active=!1},r.onLeftBtnClick=function(){var t;null==(t=this.leftBtnFunc)||t.call(this),this.node.active=!1},r.onRighBtnClick=function(){var t;null==(t=this.rightBtnFunc)||t.call(this),this.node.active=!1},n}(s)).prototype,"type",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return f.ERROR}}),T=n(k.prototype,"title",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=n(k.prototype,"content",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=n(k.prototype,"closeBtn",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=n(k.prototype,"leftBtn",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=n(k.prototype,"rightBtn",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=n(k.prototype,"leftBtnText",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=n(k.prototype,"rightBtnText",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=k))||z));r._RF.pop()}}}));

System.register("chunks:///_virtual/BaseSkill.ts",["cc"],(function(i){var t;return{setters:[function(i){t=i.cclegacy}],execute:function(){t._RF.push({},"c537buXsVlAc5lftaApShLf","BaseSkill",void 0);i("BaseSkill",(function(i,t,s,e){this.name=void 0,this.skillId=void 0,this.description=void 0,this.attribute=void 0,this.name=i,this.skillId=t,this.description=s,this.attribute=e}));t._RF.pop()}}}));

System.register("chunks:///_virtual/Cell.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MainLogic.ts","./Define.ts","./InGameManager.ts"],(function(e){var i,t,n,o,l,r,u,a,s,c,h,d,b,f,v,g;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){l=e.cclegacy,r=e._decorator,u=e.Node,a=e.Label,s=e.Vec2,c=e.Color,h=e.UITransform,d=e.Component},function(e){b=e.MainLogic},function(e){f=e.ObjectType,v=e.SkillId},function(e){g=e.InGameManager}],execute:function(){var p,T,k,S,w,y,m,x,E,C,z,O,M,F,N,B,D,I,R,H,V,L,X,_,U,G,A,W,P,j,Y,K,Q,Z,q,J,$,ee,ie,te,ne;l._RF.push({},"43224aY2xZGm6WnQz/wlYXx","Cell",void 0);var oe=r.ccclass,le=r.property;e("Cell",(p=oe("Cell"),T=le(u),k=le(a),S=le(u),w=le(a),y=le(a),m=le(u),x=le(a),E=le(u),C=le(a),z=le(u),O=le(a),M=le(u),F=le(a),N=le(a),B=le(u),D=le(a),I=le(a),R=le(a),H=le(u),p((X=i((L=function(e){function i(){for(var i,t=arguments.length,l=new Array(t),r=0;r<t;r++)l[r]=arguments[r];return i=e.call.apply(e,[this].concat(l))||this,n(i,"valueNode",X,o(i)),n(i,"valueText",_,o(i)),n(i,"seedSkill",U,o(i)),n(i,"seedTurn",G,o(i)),n(i,"seedOwner",A,o(i)),n(i,"bombSkill",W,o(i)),n(i,"bombTurn",P,o(i)),n(i,"iceSkill",j,o(i)),n(i,"iceTurn",Y,o(i)),n(i,"blockSkill",K,o(i)),n(i,"blockTurn",Q,o(i)),n(i,"thornSkill",Z,o(i)),n(i,"thornTurn",q,o(i)),n(i,"thornOwner",J,o(i)),n(i,"disguiseSkill",$,o(i)),n(i,"disguiseText",ee,o(i)),n(i,"disguiseTurn",ie,o(i)),n(i,"disguiseWarn",te,o(i)),n(i,"placeHolder",ne,o(i)),i.pos=new s,i.onClickFun=function(){},i.onMoveTouchFun=function(){},i.onEndTouchFun=function(){},i.onTouchBoardFun=function(){},i.onMoveBoardFun=function(){},i.placeholderTween=void 0,i.deltaVec=new s,i}t(i,e);var l=i.prototype;return l.start=function(){this.resetCell(),this.node.on(u.EventType.TOUCH_START,this.onCellClick,this),this.node.on(u.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(u.EventType.TOUCH_END,this.touchEnd,this)},l.update=function(e){},l.setup=function(e,i,t){this.pos=e,this.onClickFun=i,""!=t?(this.valueText.string=t,this.valueNode.active=!0):(this.valueText.string="",this.valueNode.active=!1)},l.setTouchAction=function(e,i,t){this.onClickFun=e,this.onMoveTouchFun=i,this.onEndTouchFun=t},l.updateValue=function(e){if(e=e.toString(),this.valueText.string=e,this.valueNode.active="X"==e||"O"==e,this.valueText.color="X"==e?c.RED:c.GREEN,this.seedSkill.active=e==f.SEED,this.blockSkill.active=e==f.BLOCK,this.thornSkill.active=e==f.THORN,-1!=e.indexOf(f.ICE)){var i=e.replace(f.ICE,"");this.valueText.string=i,this.valueNode.active="X"==i||"O"==i,this.valueText.color="X"==i?c.RED:c.GREEN}},l.wasUsed=function(){return this.valueNode.active},l.getValueText=function(){return this.valueText.string},l.resetCell=function(){this.valueNode.active=!1,this.valueText.string="",this.seedSkill.active=!1,this.bombSkill.active=!1,this.iceSkill.active=!1,this.blockSkill.active=!1,this.thornSkill.active=!1,this.disguiseSkill.active=!1},l.onCellClick=function(e){this.onClickFun(this.pos),this.onTouchBoardFun(e.getUILocation())},l.removeBomb=function(){this.bombSkill.active=!1},l.updateIce=function(e){this.iceSkill.active=!0,this.iceTurn.string=e.toString()},l.updateBlock=function(e){this.blockSkill.active=!0,this.blockTurn.string=e.toString()},l.removeIce=function(){this.iceSkill.active=!1},l.updateThorn=function(e){this.thornSkill.active=!0,this.thornTurn.string=e.existTurn.toString(),this.thornOwner.string=e.owner.toString()},l.removeThorn=function(){this.thornSkill.active=!1},l.removeDisguise=function(){this.disguiseSkill.active=!1},l.updateDisguise=function(e,i){this.disguiseSkill.active=!0,this.disguiseTurn.string=e.existTurn.toString(),this.disguiseWarn.string="O"==e.owner?"X":"O",this.disguiseText.string="O"==e.owner?"X":"O",this.disguiseText.color="X"==e.owner?c.GREEN:c.RED,this.disguiseTurn.node.active=e.owner==i,this.disguiseWarn.node.active=e.owner==i,i==e.owner&&(this.disguiseText.string=e.owner,this.disguiseText.color="X"==e.owner?c.RED:c.GREEN)},l.activePlaceHolder=function(){this.placeHolder.active=!0},l.deactivePlaceHolder=function(){this.placeHolder.active=!1},l.touchMove=function(e){if(g.instance.selectedSkill==v.RAIN){var i=this.node.getWorldPosition(),t=this.node.getComponent(h).width,n=new s;n.x=e.getUILocation().x-i.x,n.y=e.getUILocation().y-i.y;var o=Math.floor(Math.abs(n.x/t)),l=Math.floor(Math.abs(n.y/t));o=n.x<0?-o:o,l=n.y<0?l:-l;var r=n.x%t,u=n.y%t;if(n.x<0&&r<-t/2&&(o-=1),n.x>0&&r>t/2&&(o+=1),n.y<0&&u<t/2&&(l+=1),n.y>0&&u>t/2&&(l-=1),this.deltaVec=new s(this.pos.x+o,this.pos.y+l),this.deltaVec.x>=b._intance.sizeChess||this.deltaVec.y>=b._intance.sizeChess||this.deltaVec.x<0||this.deltaVec.y<0)return;this.onMoveTouchFun(this.deltaVec)}else this.onMoveBoardFun(e.getDelta())},l.touchEnd=function(){this.onEndTouchFun(this.pos)},l.setTouchBoardFun=function(e){this.onTouchBoardFun=e},l.setMoveBoardAction=function(e){this.onMoveBoardFun=e},l.unactiveAllSkillObject=function(){this.seedSkill.active=!1,this.bombSkill.active=!1,this.iceSkill.active=!1,this.blockSkill.active=!1,this.thornSkill.active=!1,this.disguiseSkill.active=!1},l.updateSkillObject=function(e){switch(e.skillId){case v.SEED:var i=e.existTurn-e.countTurn;this.seedSkill.active=!0,this.seedTurn.string=i.toString(),this.seedOwner.string=e.owner.toString();break;case v.BOMB:var t=e.existTurn-e.countTurn;this.bombSkill.active=!0,this.bombTurn.string=t.toString()}},i}(d)).prototype,"valueNode",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=i(L.prototype,"valueText",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=i(L.prototype,"seedSkill",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=i(L.prototype,"seedTurn",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=i(L.prototype,"seedOwner",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=i(L.prototype,"bombSkill",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=i(L.prototype,"bombTurn",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=i(L.prototype,"iceSkill",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=i(L.prototype,"iceTurn",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=i(L.prototype,"blockSkill",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=i(L.prototype,"blockTurn",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=i(L.prototype,"thornSkill",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=i(L.prototype,"thornTurn",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=i(L.prototype,"thornOwner",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=i(L.prototype,"disguiseSkill",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=i(L.prototype,"disguiseText",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=i(L.prototype,"disguiseTurn",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=i(L.prototype,"disguiseWarn",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=i(L.prototype,"placeHolder",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=L))||V));l._RF.pop()}}}));

System.register("chunks:///_virtual/Chessboard.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Cell.ts","./EventMgr.ts","./InGameManager.ts","./Define.ts","./MainLogic.ts"],(function(e){var t,o,s,i,n,r,c,a,l,h,u,d,v,p,f,g,m,P,b,C;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,s=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){n=e.cclegacy,r=e._decorator,c=e.Prefab,a=e.Node,l=e.instantiate,h=e.Vec2,u=e.Vec3,d=e.UITransform,v=e.Rect,p=e.Component},function(e){f=e.Cell},function(e){g=e.default,m=e.EventName},function(e){P=e.InGameManager},function(e){b=e.default},function(e){C=e.MainLogic}],execute:function(){var S,M,B,y,R,T,E,O,x;n._RF.push({},"41a6exRCnlGYrTxX1st1m2/","Chessboard",void 0);var _=r.ccclass,D=r.property;e("Chessboard",(S=_("Chessboard"),M=D(c),B=D(a),y=D(a),S((E=t((T=function(e){function t(){for(var t,o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return t=e.call.apply(e,[this].concat(n))||this,s(t,"cellPrefab",E,i(t)),s(t,"chessboardRender",O,i(t)),s(t,"boardMask",x,i(t)),t.cells=[],t.curTouch=void 0,t.curPlaceHolder=[],t.startTouchPos=void 0,t.curMovePos=void 0,t.curSelectPos=null,t.lastMovePos=-1,t.oldBoard=void 0,t.originBoardPos=void 0,t.curBoardScale=void 0,t.oldSkillObjects=void 0,t}o(t,e);var n=t.prototype;return n.onEnable=function(){if(0==this.cells.length){var e,t=null==(e=P.instance.curState)?void 0:e.board;this.updateBoard(t)}},n.start=function(){this.originBoardPos=this.chessboardRender.worldPosition.clone(),this.curBoardScale=this.chessboardRender.scale.clone(),g.on(m.UPDATE_BOARD,this.updateBoard,this),g.on(m.UPDATE_SKILL_OBJECT,this.updateSkillObjects,this),g.on(m.INIT_BOARD,this.initChessboard,this),g.on(m.UPDATE_ICE_SHOW,this.updateIce,this),g.on(m.UPDATE_BLOCK_SHOW,this.updateBlock,this),g.on(m.UPDATE_THORN_SHOW,this.updateThorn,this),g.on(m.UPDATE_DISGUISE_SHOW,this.updateDisguise,this),g.on(m.RESET_BOARD,this.resetChessboard,this),g.on(m.REMOVE_BOMB,this.removeBomb,this),g.on(m.REMOVE_ICE,this.removeIce,this),g.on(m.REMOVE_THORN,this.removeThorn,this),g.on(m.REMOVE_DISGUISE,this.removeDisguise,this),g.on(m.UPDATE_PLACEHODLER,this.updatePlaceholder,this),g.on(m.CLEAR_PLACEHOLDER,this.clearPlaceholder,this),g.on(m.ZOOM_IN_BOARD,this.onZoomIn,this),g.on(m.ZOOM_OUT_BOARD,this.onZoomOut,this),g.on(m.END_GAME,this.onEndGame,this)},n.update=function(e){},n.initChessboard=function(e){this.cells=[];for(var t=b.boardSize,o=0;o<t;o++)for(var s=0;s<t;s++){var i=l(this.cellPrefab),n=i.getComponent(f);n.setup(new h(s,o),this.onCellClick.bind(this),""),n.setTouchAction(this.onCellClick.bind(this),this.onCellMoveTouch.bind(this),this.onCellEndTouch.bind(this)),n.setTouchBoardFun(this.onTouchBoardPos.bind(this)),n.setMoveBoardAction(this.onMoveBoard.bind(this)),this.cells.push(i),this.chessboardRender.addChild(i)}},n.resetChessboard=function(){this.cells.forEach((function(e){return e.getComponent(f).resetCell()}))},n.onCellClick=function(e){this.curTouch=e},n.onCellEndTouch=function(e){this.curSelectPos&&h.equals(e,this.curSelectPos)?P.instance.handleCellClick(e):this.updateSeleting(e)},n.onCellMoveTouch=function(e){this.curTouch},n.convertXYtoNum=function(e,t){return e+b.boardSize*t},n.updateSeleting=function(e){if(this.curSelectPos){if(h.equals(e,this.curSelectPos))return;this.convertXYtoNum(this.curSelectPos.x,this.curSelectPos.y)!=this.lastMovePos&&this.cells[this.convertXYtoNum(this.curSelectPos.x,this.curSelectPos.y)].getComponent(f).deactivePlaceHolder()}this.cells[this.convertXYtoNum(e.x,e.y)].getComponent(f).activePlaceHolder(),this.curSelectPos=e.clone()},n.updateBoard=function(e){if(e&&(0==this.cells.length&&this.initChessboard(e),e.length>0)){for(var t=0;t<e.length;t++){var o=e[t].value;this.cells[t].getComponent(f).updateValue(o)}this.updateLastMove(e),this.showLastMove(),this.oldBoard=JSON.parse(JSON.stringify(e))}},n.updateSkillObjects=function(e){if(e&&(this.unactiveAllSkillObjects(),e.length>0))for(var t=0;t<e.length;t++)console.log("SKILL OBEJCT: ",e[t]),this.updateCellByObject(e[t])},n.unactiveAllSkillObjects=function(){this.cells.forEach((function(e){return e.getComponent(f).unactiveAllSkillObject()}))},n.updateCellByObject=function(e){var t=e.y*b.boardSize+e.x;this.cells[t].getComponent(f).updateSkillObject(e)},n.updateLastMove=function(e){var t=-1;if(this.oldBoard){for(var o=0;o<e.length;o++)if(this.oldBoard[o].value!=e[o].value){t=o;break}-1!=t&&(-1!=this.lastMovePos&&this.cells[this.lastMovePos].getComponent(f).deactivePlaceHolder(),this.lastMovePos=t)}else for(var s=0;s<e.length;s++)if(e[s].value)return void(this.lastMovePos=s)},n.showLastMove=function(){if(-1!=this.lastMovePos){this.cells[this.lastMovePos].getComponent(f).activePlaceHolder();var e=this.cells[this.lastMovePos].getWorldPosition().clone();if(!this.isInBoardView(e)){var t=new u(0);u.subtract(t,this.originBoardPos,e);var o=this.chessboardRender.position;this.chessboardRender.setPosition(o.x+t.x,o.y+t.y)}}},n.isInBoardView=function(e){var t=this.boardMask.getWorldPosition().clone(),o=this.boardMask.getComponent(d);return t.x=t.x-o.width/2,t.y=t.y-o.height/2,new v(t.x,t.y,o.width,o.height).contains(new h(e.x,e.y))},n.removeBomb=function(e){for(var t=0;t<e.length;t++){var o=e[t],s=this.convertXYtoNum(o.pos.x,o.pos.y);this.cells[s].getComponent(f).removeBomb()}},n.updateIce=function(){for(var e=C._intance.iceList,t=0;t<e.length;t++){var o=e[t],s=this.convertXYtoNum(o.pos.x,o.pos.y);this.cells[s].getComponent(f).updateIce(o.existTurn)}},n.removeIce=function(e){for(var t=0;t<e.length;t++){var o=e[t],s=this.convertXYtoNum(o.pos.x,o.pos.y);this.cells[s].getComponent(f).removeIce()}},n.updateBlock=function(){for(var e=C._intance.blockList,t=0;t<e.length;t++){var o=e[t],s=this.convertXYtoNum(o.pos.x,o.pos.y);this.cells[s].getComponent(f).updateBlock(o.existTurn)}},n.updateThorn=function(){for(var e=C._intance.thornList,t=0;t<e.length;t++){var o=e[t],s=this.convertXYtoNum(o.pos.x,o.pos.y);this.cells[s].getComponent(f).updateThorn(o)}},n.removeThorn=function(e){for(var t=0;t<e.length;t++){var o=e[t],s=this.convertXYtoNum(o.pos.x,o.pos.y);this.cells[s].getComponent(f).removeThorn()}},n.updateDisguise=function(e){for(var t=C._intance.disguiseList,o=0;o<t.length;o++){var s=t[o],i=this.convertXYtoNum(s.pos.x,s.pos.y);this.cells[i].getComponent(f).updateDisguise(s,e)}},n.removeDisguise=function(e){for(var t=0;t<e.length;t++){var o=e[t],s=this.convertXYtoNum(o.pos.x,o.pos.y);this.cells[s].getComponent(f).removeDisguise()}},n.updatePlaceholder=function(e){this.curPlaceHolder=e;for(var t=0;t<e.length;t++){var o=this.convertXYtoNum(e[t].x,e[t].y);this.cells[o].getComponent(f).activePlaceHolder()}},n.clearPlaceholder=function(e){for(var t=e||this.curPlaceHolder,o=0;o<t.length;o++){var s=this.convertXYtoNum(t[o].x,t[o].y);this.cells[s].getComponent(f).deactivePlaceHolder()}},n.onMoveBoard=function(e){var t=this.chessboardRender.position.clone();this.chessboardRender.setPosition(new u(t.x+e.x,t.y+e.y)),P.instance.isMovingBoard()||(h.add(this.curMovePos,this.curMovePos,e),(this.curMovePos.x-this.startTouchPos.x>35||this.curMovePos.y-this.startTouchPos.y>35)&&P.instance.setMovingBoard(!0))},n.onTouchBoardPos=function(e){this.startTouchPos=e.clone(),this.curMovePos=e.clone()},n.onZoomIn=function(){var e=this.chessboardRender.scale;e.x<1&&(this.chessboardRender.setScale(e.x+b.zoomChangeRate,e.y+b.zoomChangeRate),this.curBoardScale=e.clone(),this.alignFocusWhenZoom(!0))},n.onZoomOut=function(){var e=this.chessboardRender.scale;e.x>.4&&(this.chessboardRender.setScale(e.x-b.zoomChangeRate,e.y-b.zoomChangeRate),this.curBoardScale=e.clone(),this.alignFocusWhenZoom(!1))},n.alignFocusWhenZoom=function(e){var t=this.curBoardScale.x,o=e?t-b.zoomChangeRate:t+b.zoomChangeRate,s=this.chessboardRender.position;this.chessboardRender.setPosition(s.x*t/o,s.y*t/o)},n.onEndGame=function(){if(-1!=this.lastMovePos&&this.cells[this.lastMovePos].getComponent(f).deactivePlaceHolder(),this.curSelectPos){var e=this.convertXYtoNum(this.curSelectPos.x,this.curSelectPos.y);this.cells[e].getComponent(f).deactivePlaceHolder()}this.curSelectPos=null,this.lastMovePos=-1,this.oldBoard=null},t}(p)).prototype,"cellPrefab",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(T.prototype,"chessboardRender",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(T.prototype,"boardMask",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=T))||R));n._RF.pop()}}}));

System.register("chunks:///_virtual/Define.ts",["cc"],(function(n){var t,E;return{setters:[function(n){t=n.cclegacy,E=n._decorator}],execute:function(){t._RF.push({},"87e99Y8lYpFH5gGPowJVg0u","Define",void 0);E.ccclass,E.property;var i=n("SkillId",function(n){return n.NONE="NONE",n.SEED="SEED",n.BOMB="BOMB",n.RAIN="RAIN",n.QUAKE="QUAKE",n.TIME="TIME",n.FROZONE="FROZONE",n.BLOCKAGE="BLOCKAGE",n.THORN_BALL="THORN_BALL",n.DISGUISE="DISGUISE",n}({}));n("PetImgBySkill",function(n){return n.SEED="Nature_mushroom",n.BOMB="flamea",n.RAIN="Water_crab",n.QUAKE="meteor_golem",n.TIME="Fire_creature",n.BLOCKAGE="kitsune",n.FROZONE="blizzard_fox",n.THORN="Metal_hedgehog",n.DISGUISE="dumposaurus",n}({})),n("default",new function(){this.boardSize=25,this.seedGrownTurn=3,this.bombExplodeTurn=3,this.quakeNumEachSide=2,this.turnTime=25,this.timeSkillTurnNum=5,this.iceExistTurn=3,this.numBlockInBlokageSkill=3,this.blockExistTurn=3,this.thornExistTurn=5,this.thornMoveRadius=5,this.thornMoveRate=[.25,.5,.25],this.disguiseNum=3,this.disguiseExistTurn=5,this.oponentSkills=[i.SEED,i.BOMB,i.TIME],this.selfSkills=[i.SEED,i.BOMB,i.TIME],this.zoomChangeRate=.1,this.platformSrc="ETERNAL"}),n("ObjectType",function(n){return n.SEED="SEED",n.ICE="+ICE",n.THORN="THORN",n.BLOCK="BLOCK",n}({})),n("PlaceholderType",function(n){return n.NONE="NONE",n.SIZE_FIVE="SIZE_FIVE",n.X_CELLS="X_CELLS",n.O_CELLS="O_CELLS",n.EMPTY_CELLS="EMPTY_CELLS",n}({})),n("SkillName",function(n){return n.SEED="Hạt mầm hy vọng",n.BOMB="Bom hẹn lượt",n.RAIN="Cơn mưa cuốn sạch",n.QUAKE="Động đất",n.TIME="Giảm thời gian",n.BLOCKAGE="Chướng ngại vật",n.FROZONE="Đóng băng",n.THORN="Cầu gai",n.DISGUISE="Nguỵ trang",n}({})),n("SkillDes",function(n){return n.SEED="Đánh dấu 1 vị trí qua 3 turn, thì sẽ nảy mầm lên 1 quân cờ của bên mình",n.BOMB="Đặt bom lên 1 quân cờ của đối thủ, chỉ định, nổ chậm sau 3 turn",n.RAIN="Spawn 1 ô mưa kích thước (5 x 5) trên bàn cờ",n.QUAKE="Tạo động đất và phá cờ cả 2 bên (mỗi bên 2 con).",n.TIME="Trừ 50% thơi gian chơi của đối thủ trong 5 turn",n.BLOCKAGE="Tạo 3 chướng ngại vật trên bàn cờ ngăn người chơi 2 bên đặt cờ trong 3 turn.",n.FROZONE="Đóng băng quân cờ đối phương làm cho quân cờ đó không đc tính trong 3 turn kế tiếp. Sau 3 turn sẽ được tính lại bình thường.",n.THORN="Tạo 1 quả cầu gai. Sau mỗi lượt, cầu gai sẽ nhảy đến một ô bất kì(trừ những ô của người chơi). Ngăn người chơi đặt cờ và phá hủy cờ đối phương",n.DISGUISE="3 con bất kì của bên mình sẽ biến thành màu của đối phương. Nhưng vẫn tính thắng thua như bình thường.",n}({})),n("ClassicMode",function(n){return n.FREE_TO_PLAY="FREE_TO_PLAY",n.QUICK_PLAY="QUICK_PLAY",n}({})),n("PopupName",function(n){return n.ERROR="ErrorPopup",n}({})),n("MessageType",function(n){return n.NORMAL_MOVE="NORMAL_MOVE",n.SKILL_MOVE="SKILL_MOVE",n.UNKNOWN="UNKNOWN",n.CHAT="CHAT",n.PLAYER_PARTICIPATION="PLAYER_PARTICIPATION",n.ROOM_STATUS_CHANGE="ROOM_STATUS_CHANGE",n.GAME_START="GAME_START",n.ERROR="ERROR",n.RESULT="RESULT",n}({})),n("ElementType",function(n){return n.FIRE="FIRE",n.METAL="METAL",n.WATER="WATER",n.NATURE="NATURE",n.EARTH="EARTH",n}({})),n("SkillType",function(n){return n.SPAWN="SPAWN",n.PLAYER_EFFECT="PLAYER_EFFECT",n.BOARD_EFFECT="BOARD_EFFECT",n}({})),n("EffectTargetType",function(n){return n.OPPONENT="OPPONENT",n.SELF="SELF",n.CELL="CELL",n.BOARD="BOARD",n}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/DefineMatchLogin.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"5d75drwDQ5HtLbC2AHaNFbB","DefineMatchLogin",void 0);n("Config",function(n){return n.HOST="",n}({})),n("RoomType",function(n){return n.NORMAL="NORMAL",n.SKILL="SKILL",n}({})),n("RoomMode",function(n){return n.PVP="PVP",n}({})),n("PlatformSource",function(n){return n.ETERNAL="ETERNAL",n.CYBORG="CYBORG",n}({})),n("Partner",function(n){return n.COIN98="coin98",n.RAMPER="ramper",n}({})),n("PlayerStatus",function(n){return n.PLAYING="PLAYING",n.READY="READY",n.DNS="DNS",n.GAME_OVER="GAME_OVER",n.DISCONNECT="DISCONNECT",n}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/ErrorPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasePopup.ts"],(function(t){var r,o,p,e;return{setters:[function(t){r=t.inheritsLoose},function(t){o=t.cclegacy,p=t._decorator},function(t){e=t.BasePopup}],execute:function(){var u;o._RF.push({},"f3c9eqoJqZLzbRFxsbjEBUl","ErrorPopup",void 0);var n=p.ccclass;p.property,t("ErrorPopup",n("ErrorPopup")(u=function(t){function o(){return t.apply(this,arguments)||this}r(o,t);var p=o.prototype;return p.start=function(){t.prototype.start.call(this)},p.update=function(t){},p.setup=function(r){r&&t.prototype.setup.call(this,r)},o}(e))||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/EventMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(_){var E,O,A;return{setters:[function(_){E=_.inheritsLoose},function(_){O=_.cclegacy,A=_.EventTarget}],execute:function(){O._RF.push({},"faf52SkO9NEt7aLLFFy9IBQ","EventMgr",void 0);var T=function(_){function O(){return _.apply(this,arguments)||this}return E(O,_),O}(A);_("EventName",function(_){return _.LOGIN="LOGIN",_.IN_GAME="IN_GAME",_.INIT_BOARD="INIT_BOARD",_.UPDATE_BOARD="UPDATE_BOARD",_.UPDATE_SKILL_OBJECT="UPDATE_SKILL_OBJECT",_.UPDATE_SELF_MOVE_VALUE="UPDATE_SELF_MOVE_VALUE",_.END_GAME="END_GAME",_.RESET_BOARD="RESET_BOARD",_.CHANGE_SELECT_SKILL="UPDATE_SKILL_NAME",_.UPDATE_SEED_SHOW="UPDATE_SEED_SHOW",_.UPDATE_TURN_INFO="UPDATE_TURN_INFO",_.UPDATE_BOMB_SHOW="UPDATE_BOMB_SHOW",_.REMOVE_BOMB="REMOVE_BOMB",_.UPDATE_ICE_SHOW="UPDATE_ICE_SHOW",_.REMOVE_ICE="REMOVE_ICE",_.UPDATE_BLOCK_SHOW="UPDATE_BLOCK_SHOW",_.UPDATE_THORN_SHOW="UPDATE_THORN_SHOW",_.REMOVE_THORN="REMOVE_THORN",_.UPDATE_DISGUISE_SHOW="UPDATE_DISGUISE_SHOW",_.REMOVE_DISGUISE="REMOVE_DISGUISE",_.UPDATE_PLACEHODLER="UPDATE_PLACEHODLER",_.CLEAR_PLACEHOLDER="CLEAR_PLACEHOLDER",_.SHOW_TOAST="SHOW_TOAST",_.CLEAR_SKILL_USING="CLEAR_SKILL_USING",_.START_PLAY_WITH_BOT="START_PLAY_WITH_BOT",_.ZOOM_IN_BOARD="ZOOM_IN_BOARD",_.ZOOM_OUT_BOARD="ZOOM_OUT_BOARD",_.SHOW_POPUP="SHOW_POPUP",_.SHOW_OVERLAY="SHOW_OVERLAY",_.ANOTHER_JOIN_ROOM="ANOTHER_JOIN_ROOM",_.UPDATE_SELF_SESSION_ID="UPDATE_SELF_SESSION_ID",_.UPDATE_ROOM_TYPE="UPDATE_ROOM_TYPE",_.LOGIN_SUCCESS="LOGIN_SUCCESS",_.MATCH_MAKING_SUCCESS="MATCH_MAKING_SUCCESS",_.EXIT_MATCH="EXIT_MATCH",_.ROOM_STATE_CHANGE="ROOM_STATE_CHANGE",_.PLAYER_STATE_CHANGE="PLAYER_STATE_CHANGE",_}({})),_("default",new T);O._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ScreenManager.ts","./EventMgr.ts","./ScreenBase.ts"],(function(t){var e,n,i,a,o,s,c,r,u,l,E,M,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,a=t.assertThisInitialized,o=t.createClass},function(t){s=t.cclegacy,c=t._decorator,r=t.Node,u=t.Component},function(t){l=t.ScreenManager},function(t){E=t.default,M=t.EventName},function(t){h=t.ScreenType}],execute:function(){var _,g,S,G,N,f;s._RF.push({},"de361Ipqs9EUYauGmXbg8mX","GameManager",void 0);var A=c.ccclass,d=c.property,C=function(t){return t[t.NONE=0]="NONE",t[t.LOGIN=1]="LOGIN",t[t.SELECT_CORE_MODE=2]="SELECT_CORE_MODE",t[t.TEAM_SETUP=3]="TEAM_SETUP",t[t.SELECT_PLAY_TYPE=4]="SELECT_PLAY_TYPE",t[t.MATCH_MAKING=5]="MATCH_MAKING",t[t.IN_GAME=6]="IN_GAME",t[t.END_GAME=7]="END_GAME",t}(C||{});t("GameManager",(_=A("GameManager"),g=d(r),_(((f=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o))||this,i(e,"loadingOverlay",N,a(e)),e.sampleVar=0,e.state=C.NONE,e}n(e,t);var s=e.prototype;return s.onLoad=function(){null==e._instance?e._instance=this:this.node.destroy()},s.onEnable=function(){this.doSthing()},s.start=function(){this.handleCustomEvent(),this.setState(C.LOGIN)},s.handleCustomEvent=function(){E.on(M.LOGIN_SUCCESS,this.onLoginSuccess,this),E.on(M.MATCH_MAKING_SUCCESS,this.onMatchMakingSuccess,this),E.on(M.EXIT_MATCH,this.onExitMatch,this)},s.getCurGameState=function(){return this.state},s.doSthing=function(){console.log("GM do Something")},s.setState=function(t){if(this.state!=t)switch(this.state=t,this.state){case C.LOGIN:E.emit(M.LOGIN);break;case C.MATCH_MAKING:l.instance.showScreen(h.MATCHING);break;case C.IN_GAME:console.log("VO IN GAME"),E.emit(M.IN_GAME)}},s.onLoginSuccess=function(){this.setState(C.MATCH_MAKING)},s.onMatchMakingSuccess=function(){console.log("IN--------GAME"),this.setState(C.IN_GAME)},s.onExitMatch=function(){this.setState(C.MATCH_MAKING)},s.showLoadingOverlay=function(){this.loadingOverlay.active=!0},s.hideLoadingOverlay=function(){this.loadingOverlay.active=!1},o(e,null,[{key:"instance",get:function(){return this._instance||console.error("GameManger is not initialized!"),this._instance}}]),e}(u))._instance=null,N=e((G=f).prototype,"loadingOverlay",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=G))||S));s._RF.pop()}}}));

System.register("chunks:///_virtual/InGameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WebSocketHandler.ts","./EventMgr.ts","./ScreenManager.ts","./BaseSkill.ts","./SkillInfo.ts","./Define.ts","./ScreenBase.ts","./DefineMatchLogin.ts"],(function(e){var n,t,i,s,o,l,a,c,r,u,S,h,d,f,T,I;return{setters:[function(e){n=e.inheritsLoose,t=e.createClass},function(e){i=e.cclegacy,s=e._decorator,o=e.Component},function(e){l=e.WebSocketHandler},function(e){a=e.default,c=e.EventName},function(e){r=e.ScreenManager},function(e){u=e.BaseSkill},function(e){S=e.SkillInfo},function(e){h=e.default,d=e.SkillId,f=e.EffectTargetType},function(e){T=e.ScreenType},function(e){I=e.RoomType}],execute:function(){var E,k;i._RF.push({},"8b9dczhUVJJE5CwpuEy47iX","InGameManager",void 0);var p=s.ccclass,g=(s.property,function(e){return e[e.NONE=0]="NONE",e[e.START=1]="START",e[e.RESUME=2]="RESUME",e[e.IN_TURN=3]="IN_TURN",e[e.WIN=4]="WIN",e[e.LOSE=5]="LOSE",e}(g||{}));e("InGameManager",p("InGameManager")(((k=function(e){function i(){for(var n,t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return(n=e.call.apply(e,[this].concat(i))||this).inGameState=g.NONE,n.sampleVar=0,n.curSessionID="",n.curTurn=!1,n.selectedSkill="",n.boardMoving=!1,n.roomType=null,n.classicMode=null,n.curState=null,n.selfSkills=void 0,n.oponentSkills=void 0,n.moveValue="",n}n(i,e);var s=i.prototype;return s.setState=function(e){if(console.log("SET STATE: ",e),console.log("CUR STATE: ",this.inGameState),this.inGameState!=e)switch(this.inGameState=e,this.inGameState){case g.START:console.log("SET START state INGAME MANAGER"),r.instance.showScreen(T.IN_GAME);break;case g.IN_TURN:break;case g.RESUME:this.roomType==I.SKILL&&(this.initSelfSkill(),this.initOponentSkill());break;case g.LOSE:case g.WIN:}},s.initSelfSkill=function(){for(var e=this,n=function(n){var t=S.find((function(e){return e.skillId==h.selfSkills[n]}));if(t){var i=new u(t.name,t.skillId,t.description,t.attributes);e.selfSkills.insertSkill(h.selfSkills[n],i)}},t=0;t<h.selfSkills.keys.length;t++)n(t)},s.initOponentSkill=function(){for(var e=this,n=function(n){var t=S.find((function(e){return e.skillId==h.oponentSkills[n]}));if(t){var i=new u(t.name,t.skillId,t.description,t.attributes);e.oponentSkills.insertSkill(h.oponentSkills[n],i)}},t=0;t<h.oponentSkills.keys.length;t++)n(t)},s.onLoad=function(){null==i._instance?i._instance=this:this.node.destroy(),a.on(c.IN_GAME,this.onInGame,this),console.log("INGAME LOAD")},s.start=function(){a.on(c.UPDATE_SELF_SESSION_ID,this.setCurSessionID,this),a.on(c.ROOM_STATE_CHANGE,this.handleStateChange,this),a.on(c.PLAYER_STATE_CHANGE,this.handlePlayerChange,this)},s.onInGame=function(){console.log("ON IN GAME"),this.setState(g.START)},s.setCurSessionID=function(e){this.curSessionID=e},s.handleStateChange=function(e){console.log("State CHANGE: ",e),this.curState=e,this.updateBoard([].concat(e.board)),this.updateResult(e.winner),this.roomType==I.SKILL&&this.updateSkillObject(e.skillObjects),e.currentTurn==this.curSessionID?this.curTurn=!0:this.curTurn=!1,this.updateTurn()},s.handlePlayerChange=function(e,n){e&&(n==this.curSessionID?this.moveValue=e.moveValue:this.moveValue="X"==e.moveValue?"O":"X")},s.updateBoard=function(e){a.emit(c.UPDATE_BOARD,e)},s.updateResult=function(e){null!=e&&e.winnerId&&(this.setState(e.winnerId==this.curSessionID?g.WIN:g.LOSE),console.log("WIIIINNN :",e.winnerId),a.emit(c.END_GAME,e.winnerId==this.curSessionID))},s.updateSkillObject=function(e){a.emit(c.UPDATE_SKILL_OBJECT,e)},s.updateTurn=function(){a.emit(c.UPDATE_TURN_INFO,this.curTurn)},s.handleCellClick=function(e){var n;this.boardMoving?this.boardMoving=!1:this.curTurn&&(console.log("HANDLE CELL CLICK ",e),""!=this.selectedSkill?(l.instance.sendSkillMove({skillId:this.selectedSkill,x:e.x,y:e.y}),this.selectedSkill=""):null==(n=l.instance)||n.sendMove({moveType:"NORMAL",x:e.x,y:e.y}))},s.handleSkill=function(e){console.log(e),e===d.QUAKE||e===d.BLOCKAGE||e==d.TIME?l.instance.sendSkillMove({skillId:e,targetType:f.OPPONENT,x:0,y:0}):this.selectedSkill=e},s.isMovingBoard=function(){return this.boardMoving},s.setMovingBoard=function(e){this.boardMoving=e},s.setRoomType=function(e){this.roomType=e,a.emit(c.UPDATE_ROOM_TYPE)},s.setClassicMode=function(e){this.classicMode=e},s.leaveRoom=function(){l.instance.leave(),a.emit(c.EXIT_MATCH)},t(i,null,[{key:"instance",get:function(){return this._instance||console.error("InGameManger is not initialized!"),this._instance}}]),i}(o))._instance=null,E=k))||E);i._RF.pop()}}}));

System.register("chunks:///_virtual/InGameScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventMgr.ts","./InGameManager.ts","./Define.ts","./MainLogic.ts","./SkillButton.ts","./ScreenBase.ts","./DefineMatchLogin.ts"],(function(e){var i,t,n,l,o,r,s,u,a,c,f,S,k,p,h,g,m,b,T,y,I,d,E,v,B;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,l=e.assertThisInitialized},function(e){o=e.cclegacy,r=e._decorator,s=e.Button,u=e.Node,a=e.Label,c=e.Prefab,f=e.instantiate,S=e.tween,k=e.UIOpacity},function(e){p=e.default,h=e.EventName},function(e){g=e.InGameManager},function(e){m=e.default,b=e.SkillId,T=e.ClassicMode,y=e.SkillName,I=e.SkillDes},function(e){d=e.MainLogic},function(e){E=e.SkillButton},function(e){v=e.ScreenBase},function(e){B=e.RoomType}],execute:function(){var N,O,A,C,R,G,z,U,w,L,_,D,M,P,x,K,Z,F,H,Y,Q,W,q,V,j,X,J,$,ee,ie,te,ne,le,oe,re,se,ue,ae,ce,fe,Se,ke,pe,he,ge,me,be,Te,ye,Ie,de,Ee,ve;o._RF.push({},"2590f3wWD9IyaUKK0XupVSt","InGameScreen",void 0);var Be=r.ccclass,Ne=r.property;e("InGameScreen",(N=Be("InGameScreen"),O=Ne(s),A=Ne(u),C=Ne(a),R=Ne(u),G=Ne(u),z=Ne(a),U=Ne(a),w=Ne({group:{name:"Turn",style:"section"}}),L=Ne(u),_=Ne({group:{name:"Turn",style:"section"}}),D=Ne(u),M=Ne({group:{name:"Skill Info",style:"section"}}),P=Ne(u),x=Ne({group:{name:"Skill Info",style:"section"}}),K=Ne(a),Z=Ne({group:{name:"Skill Info",style:"section"}}),F=Ne(a),H=Ne({group:{name:"Skill Info",style:"section"}}),Y=Ne(a),Q=Ne({group:{name:"Skill Info",style:"section"}}),W=Ne(a),q=Ne({group:{name:"Skill Info",style:"section"}}),V=Ne(s),j=Ne(u),X=Ne(u),J=Ne(c),$=Ne({group:{name:"Zoom",style:"section"}}),ee=Ne(s),ie=Ne({group:{name:"Zoom",style:"section"}}),te=Ne(s),N((oe=i((le=function(e){function i(){for(var i,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return i=e.call.apply(e,[this].concat(o))||this,n(i,"exitBtn",oe,l(i)),n(i,"resultNotiNode",re,l(i)),n(i,"resultText",se,l(i)),n(i,"freeToPlayResultGift",ue,l(i)),n(i,"quickPlayResultGift",ae,l(i)),n(i,"turnText",ce,l(i)),n(i,"usingSkill",fe,l(i)),n(i,"oponentActiveBg",Se,l(i)),n(i,"selfActiveBg",ke,l(i)),n(i,"selfSkillInfo",pe,l(i)),n(i,"selfSkillName",he,l(i)),n(i,"selfSkillDes",ge,l(i)),n(i,"oponentTime",me,l(i)),n(i,"selfTime",be,l(i)),n(i,"useSkillBtn",Te,l(i)),n(i,"selfSkillContainer",ye,l(i)),n(i,"oponentSkillContainer",Ie,l(i)),n(i,"skillButtonPref",de,l(i)),n(i,"zoomIn",Ee,l(i)),n(i,"zoomOut",ve,l(i)),i.curSelectSkill=null,i.selfSkills=[],i.oponentSkills=[],i.curTurn=null,i.curTime=0,i}t(i,e);var o=i.prototype;return o.start=function(){this.exitBtn.node.on("click",this.onExitClick,this),this.useSkillBtn.node.on("click",this.onUseSkillClick,this),this.zoomIn.node.on("click",this.onZoomInClick,this),this.zoomOut.node.on("click",this.onZoomOutClick,this),p.on(h.END_GAME,this.onEndGame,this),p.on(h.UPDATE_TURN_INFO,this.updateTurnInfo,this),p.on(h.CLEAR_SKILL_USING,this.clearSkillUsing,this),p.on(h.UPDATE_ROOM_TYPE,this.onUpdateRoomType,this),p.on(h.CHANGE_SELECT_SKILL,this.onSelectedSkillChange,this),console.log("IN game START"),p.emit(h.SHOW_TOAST,"Touch 2 times to confirm the position of chess piece")},o.onEnable=function(){this.resultNotiNode.active=!1;var e=g.instance.roomType;this.setupBoard(e);var i=g.instance.curTurn;this.updateTurnInfo(i)},o.onUpdateRoomType=function(){var e=g.instance.roomType;this.setupBoard(e)},o.setupBoard=function(e){e==B.SKILL?(this.setupSkill(),this.selfSkillInfo.active=!0):(this.clearSkillUI(),this.selfSkillInfo.active=!1)},o.update=function(e){this.curTurn&&(this.curTime-=e,this.oponentActiveBg.active=!this.curTurn,this.selfActiveBg.active=this.curTurn,(this.curTurn?this.selfTime:this.oponentTime).string=Math.floor(this.curTime).toString())},o.onResetClick=function(){d._intance.resetBoad()},o.onExitClick=function(){this.resultNotiNode.active=!1,g.instance.leaveRoom()},o.onUseSkillClick=function(){g.instance.handleSkill(this.curSelectSkill),this.clearUsingSkillText()},o.setupSkill=function(){this.clearSkillUI();for(var e=0;e<m.oponentSkills.length;e++){var i=m.oponentSkills[e],t=f(this.skillButtonPref);t.getComponent(E).setup(i),this.oponentSkillContainer.addChild(t)}for(var n=0;n<m.selfSkills.length;n++){var l=m.selfSkills[n],o=f(this.skillButtonPref);o.getComponent(E).setup(l),this.selfSkillContainer.addChild(o)}},o.clearSkillUI=function(){this.oponentSkillContainer.destroyAllChildren(),this.oponentSkillContainer.removeAllChildren(),this.selfSkillContainer.destroyAllChildren(),this.selfSkillContainer.removeAllChildren()},o.onSelectedSkillChange=function(e){this.updateSkillName(e),this.curSelectSkill=e},o.clearUsingSkillText=function(){this.curSelectSkill=b.NONE,this.updateSkillName(this.curSelectSkill)},o.onEndGame=function(e){var i=this;this.resultText.string=e?"You WIN":"You LOSE",p.emit(h.SHOW_TOAST,e?"You WIN":"You LOSE"),this.scheduleOnce((function(){i.showEndGameResult()}),2)},o.showEndGameResult=function(){this.resultNotiNode.active=!0;var e=g.instance;e.roomType==B.NORMAL?(this.freeToPlayResultGift.active=e.classicMode==T.FREE_TO_PLAY,this.quickPlayResultGift.active=e.classicMode==T.QUICK_PLAY):(this.freeToPlayResultGift.active=!1,this.quickPlayResultGift.active=!1)},o.updateSkillName=function(e){var i=this.selfSkillName,t=this.selfSkillDes;switch(e){case b.SEED:this.usingSkill.string="Skill:"+y.SEED,i.string=y.SEED,t.string=I.SEED;break;case b.BOMB:this.usingSkill.string="Skill:"+y.BOMB,i.string=y.BOMB,t.string=I.BOMB;break;case b.RAIN:this.usingSkill.string="Skill:"+y.RAIN,i.string=y.RAIN,t.string=I.RAIN;break;case b.QUAKE:this.usingSkill.string="Skill:"+y.QUAKE,i.string=y.QUAKE,t.string=I.QUAKE;break;case b.TIME:this.usingSkill.string="Skill:"+y.TIME,i.string=y.TIME,t.string=I.TIME;break;case b.BLOCKAGE:this.usingSkill.string="Skill:"+y.BLOCKAGE,i.string=y.BLOCKAGE,t.string=I.BLOCKAGE;break;case b.FROZONE:this.usingSkill.string="Skill:"+y.FROZONE,i.string=y.FROZONE,t.string=I.FROZONE;break;case b.THORN_BALL:this.usingSkill.string="Skill: "+y.THORN,i.string=y.THORN,t.string=I.THORN;break;case b.DISGUISE:this.usingSkill.string="Skill: "+y.DISGUISE,i.string=y.DISGUISE,t.string=I.DISGUISE;break;case b.NONE:}},o.updateTurnInfo=function(e){this.curTurn!=e&&(this.curTurn=e,this.curTime=m.turnTime,this.turnText.string=e?g.instance.moveValue:"",this.oponentActiveBg.active=!e,this.selfActiveBg.active=e,this.selfTime.node.active=e,this.oponentTime.node.active=!e,this.flickerPlayerBg())},o.clearSkillUsing=function(){this.selfSkillName.string="----------------",this.selfSkillDes.string="-------"},o.flickerPlayerBg=function(){S(this.oponentActiveBg.getComponent(k)).to(.5,{opacity:10}).to(.5,{opacity:255}).union().repeatForever().start(),S(this.selfActiveBg.getComponent(k)).to(.5,{opacity:10}).to(.5,{opacity:255}).union().repeatForever().start()},o.onNoSkillClick=function(){d._intance.unuseSkill()},o.onZoomInClick=function(){p.emit(h.ZOOM_IN_BOARD)},o.onZoomOutClick=function(){p.emit(h.ZOOM_OUT_BOARD)},i}(v)).prototype,"exitBtn",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=i(le.prototype,"resultNotiNode",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),se=i(le.prototype,"resultText",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=i(le.prototype,"freeToPlayResultGift",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=i(le.prototype,"quickPlayResultGift",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=i(le.prototype,"turnText",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fe=i(le.prototype,"usingSkill",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Se=i(le.prototype,"oponentActiveBg",[w,L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ke=i(le.prototype,"selfActiveBg",[_,D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pe=i(le.prototype,"selfSkillInfo",[M,P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),he=i(le.prototype,"selfSkillName",[x,K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ge=i(le.prototype,"selfSkillDes",[Z,F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),me=i(le.prototype,"oponentTime",[H,Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),be=i(le.prototype,"selfTime",[Q,W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Te=i(le.prototype,"useSkillBtn",[q,V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ye=i(le.prototype,"selfSkillContainer",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ie=i(le.prototype,"oponentSkillContainer",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),de=i(le.prototype,"skillButtonPref",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ee=i(le.prototype,"zoomIn",[$,ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ve=i(le.prototype,"zoomOut",[ie,te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=le))||ne));o._RF.pop()}}}));

System.register("chunks:///_virtual/JoinRoomRequest.ts",["cc","./DefineMatchLogin.ts","./UserManager.ts"],(function(e){var o,r,t,n;return{setters:[function(e){o=e.cclegacy},function(e){r=e.RoomType,t=e.RoomMode},function(e){n=e.UserManager}],execute:function(){o._RF.push({},"93cafETaO9CSpOYabClWOsm","JoinRoomRequest",void 0);e("JoinRoomRequest",function(){function e(){}var o=e.prototype;return o.getInfoNormalMode=function(){var e=n.instance.userProfile;return{roomType:r.NORMAL,roomMode:t.PVP,address:e.wallets.tomo.publicKey,avatar:"",username:e.tgUser.userName}},o.getInfoSkillMode=function(){var e=n.instance.userProfile;return{roomType:r.SKILL,roomMode:t.PVP,address:e.wallets.tomo.publicKey,avatar:"",username:e.tgUser.userName}},e}());o._RF.pop()}}}));

System.register("chunks:///_virtual/LoadingOverlay.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,r,e,o;return{setters:[function(t){n=t.inheritsLoose},function(t){r=t.cclegacy,e=t._decorator,o=t.Component}],execute:function(){var a;r._RF.push({},"b32b9/JQHhAQqR9bz5B9cfX","LoadingOverlay",void 0);var c=e.ccclass;e.property,t("LoadingOverlay",c("LoadingOverlay")(a=function(t){function r(){return t.apply(this,arguments)||this}n(r,t);var e=r.prototype;return e.start=function(){},e.update=function(t){},r}(o))||a);r._RF.pop()}}}));

System.register("chunks:///_virtual/LoginManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var r,t,e,o;return{setters:[function(n){r=n.inheritsLoose},function(n){t=n.cclegacy,e=n._decorator,o=n.Component}],execute:function(){var a;t._RF.push({},"db213vsIpNJO47Bu9ZIB//U","LoginManager",void 0);var c=e.ccclass;e.property,n("LoginManager",c("LoginManager")(a=function(n){function t(){for(var r,t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return(r=n.call.apply(n,[this].concat(e))||this).userProfile=null,r}r(t,n);var e=t.prototype;return e.start=function(){},e.update=function(n){},t}(o))||a);t._RF.pop()}}}));

System.register("chunks:///_virtual/LoginScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.cjs.mjs_cjs=&original=.js","./EventMgr.ts","./ScreenBase.ts","./DefineMatchLogin.ts","./UserManager.ts","./Define.ts","./index.cjs.js"],(function(e){var t,n,i,o,r,a,s,c,l,u,f,d,g,p,h,b,R,v,N,C,B;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized,r=e.extends,a=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){c=e.cclegacy,l=e._decorator,u=e.Label,f=e.Node,d=e.Button,g=e.EditBox},null,function(e){p=e.default,h=e.EventName},function(e){b=e.ScreenBase},function(e){R=e.Partner},function(e){v=e.UserManager},function(e){N=e.PopupName,C=e.default},function(e){B=e.default}],execute:function(){var m,T,y,x,S,k,w,E,P,M,I,L,D,J,W,O,z,F,U,G,A,V,j,_,K,H,q,X,Y;c._RF.push({},"a4016d4eUFEdKT90FkTNVFW","LoginScreen",void 0);var Q=l.ccclass,Z=l.property;e("LoginScreen",(m=Q("LoginScreen"),T=Z(u),y=Z(u),x=Z(u),S=Z(u),k=Z(f),w=Z(f),E=Z(f),P=Z(f),M=Z(f),I=Z(f),L=Z(f),D=Z(d),J=Z(d),m((z=t((O=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,i(t,"webMsgText",z,o(t)),i(t,"userRefText",F,o(t)),i(t,"userProfileText",U,o(t)),i(t,"sdkVerText",G,o(t)),i(t,"indiciator",A,o(t)),i(t,"signMsgButtonNode",V,o(t)),i(t,"gameConnectButtonNode",j,o(t)),i(t,"getReferralButtonNode",_,o(t)),i(t,"setReferralButtonNode",K,o(t)),i(t,"copyRefCodeButtonNode",H,o(t)),i(t,"setRefCodeEditBoxNode",q,o(t)),i(t,"fakePassLogin",X,o(t)),i(t,"copyJWT",Y,o(t)),t.userRefInfo=null,t.targetRefCode="",t.JWT="",t.appID="knywqhljpx",t}n(t,e);var c=t.prototype;return c.start=function(){var e=this;this.indiciator.active=!0,this.signMsgButtonNode.active=!1,this.gameConnectButtonNode.active=!1,this.getReferralButtonNode.active=!1,this.setReferralButtonNode.active=!0;var t={gameId:"eternal",partner:R.COIN98,appId:this.appID,source:"ETERNAL",onSignInFail:function(t){console.error("ev onSignInFail",t),e.indiciator.active=!1},onSignInSucess:function(t){console.log("sign-in-success",t),v.instance.userProfile=r({},t.data);var n=v.instance.userProfile;console.log("USER PROFILE : ",n),e.updateUserProfile(),console.log(v.instance.userProfile),e.webMsgText.string="Hello "+n.tgUser.name,e.indiciator.active=!1;var i=r({},n.wallets.tomo);i&&(e.webMsgText.string+="\nChain:"+n.chainConfig+"\nPublicKey:"+JSON.stringify(i.publicKey)),e.gameConnectButtonNode.active=!0,e.getReferralButtonNode.active=!1,e.setReferralButtonNode.active=!0,e.signMsgButtonNode.active=!1},onSignMessage:function(t){e.webMsgText.string+="\n"+t,console.log("sign-message-success",t),e.indiciator.active=!1,e.gameConnectButtonNode.active=!0,e.getReferralButtonNode.active=!1,e.setReferralButtonNode.active=!0,e.signMsgButtonNode.active=!1,e.updateUserProfile()}};B.initializeAsync(t,"preprod").then((function(){console.log("Init ramper success "+B.getSDKVersion()),e.sdkVerText.string+="\nSDK-"+B.getSDKVersion()})).catch((function(e){console.error(e.message)})),this.gameConnectButtonNode.on("click",this.onClickGameConnect.bind(this)),this.getReferralButtonNode.on("click",this.onClickGetReferral.bind(this)),this.copyRefCodeButtonNode.on("click",this.onClickClipboardRefCode.bind(this)),this.signMsgButtonNode.on("click",(function(){e.indiciator.active=!0,e.signMsgButtonNode.active=!1})),this.setReferralButtonNode.children[1].on("click",this.onClickSetReferral.bind(this)),this.setReferralButtonNode.children[0].on("editing-did-ended",this.onEditingDidEnded.bind(this)),this.fakePassLogin.node.on("click",this.onFakePassLoginClick,this),this.copyJWT.node.on("click",this.onCopyJWTClick,this)},c.onEditingDidEnded=function(e){console.log("[editingDidEnded]"+e.string),this.targetRefCode=e.string,this.setReferralButtonNode.children[1].active=!0},c.updateUserProfile=function(){var e=v.instance.userProfile;if(e&&(this.userProfileText.string="Name:"+e.tgUser.name+"\nAddress:"+e.wallets.tomo.publicKey),this.userRefText.node.active=!1,this.userRefText.string="",this.userRefInfo)for(var t in this.userRefInfo)this.userRefText.node.active=!0,this.userRefText.string+=t+": "+this.userRefInfo[t]+"\n"},c.onClickClipboardRefCode=function(e){this.copyRefCode(this.userRefInfo.refCode)},c.copyRefCode=function(){var e=a(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.writeText(t);case 3:console.log("Text copied to clipboard:",t),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Failed to copy: ",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),c.onClickGameConnect=function(e){var t=this;this.indiciator.active=!0,this.gameConnectButtonNode.active=!1,B.gameConnect().then((function(e){if(t.webMsgText.string=JSON.stringify(e),t.JWT=JSON.stringify(e),t.getReferralButtonNode.active=!0,t.setReferralButtonNode.active=!1,t.indiciator.active=!1,t.isTokenExpired(JSON.stringify(e))){var n={title:"JWT EXPIRED!!!",content:"Your JWT has been expried, sign message and connect again",leftBtnText:"Close",leftBtnFunction:function(){t.signMsgButtonNode.active=!0},rightBtnText:"Cancel"};p.emit(h.SHOW_POPUP,N.ERROR,n)}else p.emit(h.LOGIN_SUCCESS)})).catch((function(e){return console.error(e)}))},c.onClickSetReferral=function(e){this.indiciator.active=!0,this.setReferralButtonNode.active=!1,console.log("NEW LIB RAMPER DON'T HAVE SET REFERAL")},c.onClickGetReferral=function(e){var t=this;this.indiciator.active=!0,this.getReferralButtonNode.active=!1,B.getReferral().then((function(e){t.userRefInfo=r({},e.data),t.webMsgText.string=JSON.stringify(e),t.gameConnectButtonNode.active=!1,t.setReferralButtonNode.active=!0,t.indiciator.active=!1,t.updateUserProfile(),console.log("[Main]onClickGetReferral",e)})).catch((function(e){return console.error(e)}))},c.onWebViewLoaded=function(){console.log("WebView has finished loading")},c.onFakePassLoginClick=function(){p.emit(h.LOGIN_SUCCESS)},c.onCopyJWTClick=function(){navigator.clipboard.writeText(this.JWT),this.setRefCodeEditBoxNode.getComponent(g).string=this.JWT,console.log("COPIED JWT TO CLIPBOARD: ",this.JWT)},c.onSignMessageClick=function(){var e=this.GetSignMessage();B.signMessage(e,this.appID)},c.GetSignMessage=function(){return"Welcome to NinetyEight ecosystem!|"+C.platformSrc+"|"+Date.now().toLocaleString("en-CA")},c.isTokenExpired=function(e){var t=e.split(".")[1],n=JSON.parse(atob(t)),i=Math.floor(Date.now()/1e3);return n.exp<i},t}(b)).prototype,"webMsgText",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(O.prototype,"userRefText",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(O.prototype,"userProfileText",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(O.prototype,"sdkVerText",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(O.prototype,"indiciator",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(O.prototype,"signMsgButtonNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(O.prototype,"gameConnectButtonNode",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(O.prototype,"getReferralButtonNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(O.prototype,"setReferralButtonNode",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(O.prototype,"copyRefCodeButtonNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(O.prototype,"setRefCodeEditBoxNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(O.prototype,"fakePassLogin",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(O.prototype,"copyJWT",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=O))||W));c._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./InGameScreen.ts","./LoginManager.ts","./LoginScreen.ts","./JoinRoomRequest.ts","./MatchingScreen.ts","./BasePopup.ts","./ErrorPopup.ts","./LoadingOverlay.ts","./DefineMatchLogin.ts","./BaseSkill.ts","./MoveResponse.ts","./SkillInfo.ts","./SkillObject.ts","./SkillRepository.ts","./UserProfile.ts","./EventMgr.ts","./GameManager.ts","./InGameManager.ts","./PopupManager.ts","./ScreenManager.ts","./SoundManager.ts","./UserManager.ts","./Cell.ts","./Chessboard.ts","./Define.ts","./SpawnObject.ts","./MainLogic.ts","./SkillButton.ts","./APIHandler.ts","./NetworkManager.ts","./WebSocketHandler.ts","./ScreenBase.ts","./ToastHolder.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MainLogic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Define.ts","./EventMgr.ts"],(function(t){var i,s,e,n,r,o,h,u,a,l,c,f;return{setters:[function(t){i=t.inheritsLoose,s=t.createClass},function(t){e=t.cclegacy,n=t.Vec2,r=t.Rect,o=t.Component},function(t){h=t.default,u=t.SkillId,a=t.PlaceholderType,l=t.ObjectType},function(t){c=t.default,f=t.EventName}],execute:function(){e._RF.push({},"fd028cUNWNHw4xryux6RrFZ","MainLogic",void 0),t("MainLogic",function(t){function e(){var i;return(i=t.call(this)||this).sizeChess=25,i.turn=0,i.chessboard=[],i.seedList=[],i.bombList=[],i.iceList=[],i.blockList=[],i.thornList=[],i.disguiseList=[],i.removeSkillList=[],i.initDone=!1,i.curPlaceholder=[],i.curUsingSkill=u.NONE,i.timeSchedule=void 0,i.curTime=0,i.oTurnReduceTime=0,i.xTurnReduceTime=0,i.isPlayWithBot=!1,i.boardMoving=!1,i}i(e,t);var o=e.prototype;return o.startCountTime=function(){var t=this;this.curTime=0,this.timeSchedule=setInterval((function(){t.curTime+=1;var i=t.xTurnReduceTime>0?Math.ceil(h.turnTime/2):h.turnTime,s=t.oTurnReduceTime>0?Math.ceil(h.turnTime/2):h.turnTime,e=t.turn%2==0?s:i;t.curTime>=e&&(c.emit(f.END_GAME,t.turn+1),t.endCountTime())}),1e3)},o.endCountTime=function(){this.curTime=0,clearInterval(this.timeSchedule)},o.initChessboardData=function(){for(var t=0;t<this.sizeChess;t++){this.chessboard[t]=[];for(var i=0;i<this.sizeChess;i++)this.chessboard[t].push("")}c.emit(f.INIT_BOARD),this.initDone=!0,this.startCountTime()},o.toggleSkill=function(t){c.emit(f.CLEAR_PLACEHOLDER),this.curUsingSkill=t,t==u.NONE&&this.showPlaceHolder(a.NONE)},o.unuseSkill=function(){this.toggleSkill(u.NONE)},o.nextTurn=function(){this.turn+=1,this.curTime=0,this.curUsingSkill=u.NONE,this.updateSeedByTurn(),this.updateBombByTurn(),this.updateIceByTurn(),this.updateBlockByTurn(),this.updateThornByTurn(),this.updateDisguiseByTurn(),c.emit(f.UPDATE_BOARD),c.emit(f.UPDATE_SEED_SHOW),c.emit(f.UPDATE_BOMB_SHOW),c.emit(f.UPDATE_ICE_SHOW),c.emit(f.UPDATE_BLOCK_SHOW),c.emit(f.UPDATE_THORN_SHOW),c.emit(f.UPDATE_DISGUISE_SHOW,this.turn%2==0?"O":"X"),c.emit(f.UPDATE_TURN_INFO,this.turn%2==0?"O":"X"),this.oTurnReduceTime>0&&(this.oTurnReduceTime-=1),this.xTurnReduceTime>0&&(this.xTurnReduceTime-=1),c.emit(f.CLEAR_SKILL_USING),this.isPlayWithBot&&this.turn%2==1&&this.onInBotTurn()},o.isMovingBoard=function(){return this.boardMoving},o.setMovingBoard=function(t){this.boardMoving=t},o.selectedCellStart=function(t){this.curUsingSkill==u.RAIN&&(c.emit(f.CLEAR_PLACEHOLDER,this.curPlaceholder),this.curPlaceholder=this.getPlaceholder(a.SIZE_FIVE,t),c.emit(f.UPDATE_PLACEHODLER,this.curPlaceholder))},o.selectedCellChange=function(t){this.curUsingSkill==u.RAIN&&(c.emit(f.CLEAR_PLACEHOLDER,this.curPlaceholder),this.curPlaceholder=this.getPlaceholder(a.SIZE_FIVE,t),c.emit(f.UPDATE_PLACEHODLER,this.curPlaceholder))},o.selectedCellConfirm=function(t){if(this.boardMoving)this.boardMoving=!1;else switch(this.curUsingSkill){case u.SEED:this.setSeedAt(t)&&(this.toggleSkill(u.NONE),this.showPlaceHolder(a.NONE),c.emit(f.UPDATE_SEED_SHOW));break;case u.BOMB:this.setBombAt(t)?(this.toggleSkill(u.NONE),this.showPlaceHolder(a.NONE),c.emit(f.UPDATE_BOMB_SHOW)):c.emit(f.SHOW_TOAST,"Invalid bomb pos");break;case u.RAIN:console.log("CONFIRM CHANGE: ",t);var i=this.curPlaceholder;this.rainInRegion(i),c.emit(f.UPDATE_SEED_SHOW),c.emit(f.UPDATE_BOMB_SHOW),c.emit(f.UPDATE_BOARD),c.emit(f.CLEAR_PLACEHOLDER,this.curPlaceholder),this.curPlaceholder=[],this.toggleSkill(u.NONE);break;case u.FROZONE:this.setIceAt(t)?(this.toggleSkill(u.NONE),this.showPlaceHolder(a.NONE),c.emit(f.UPDATE_ICE_SHOW)):c.emit(f.SHOW_TOAST,"Invalid ice pos");break;case u.THORN_BALL:this.setThornAt(t)?(this.toggleSkill(u.NONE),this.showPlaceHolder(a.NONE),c.emit(f.UPDATE_THORN_SHOW)):c.emit(f.SHOW_TOAST,"Invalid thorn pos");break;default:this.addStone(t.x,t.y,this.turn%2==1)&&(this.checkWin(t,this.chessboard)?c.emit(f.END_GAME,this.turn):(this.nextTurn(),c.emit(f.UPDATE_BOARD)))}},o.addStone=function(t,i,s){var e=!1,r=s?"X":"O";if(""==this.chessboard[t][i]&&(this.chessboard[t][i]=r,e=!0),this.chessboard[t][i]==l.SEED){var o=this.findSeedAt(new n(t,i));o&&o.owner!=r&&(this.removeSeedAt(new n(t,i)),this.chessboard[t][i]=r,e=!0)}return e},o.resetBoad=function(){for(var t=0;t<this.sizeChess;t++)for(var i=0;i<this.sizeChess;i++)this.chessboard[i][t]="";this.seedList=[],this.bombList=[],this.iceList=[],this.blockList=[],this.thornList=[],this.disguiseList=[],c.emit(f.UPDATE_TURN_INFO,!1),c.emit(f.RESET_BOARD),this.turn=0,this.endCountTime(),this.startCountTime(),this.oTurnReduceTime=0,this.xTurnReduceTime=0,this.unuseSkill()},o.getBoardAtPos=function(t,i,s){return t<0||t>=this.sizeChess||i<0||i>=this.sizeChess?null:s[t][i]},o.checkWin=function(t,i,s){for(var e=0,n=t.x,r=t.x,o=t.y,h=s||this.getBoardAtPos(r,o,i);this.getBoardAtPos(n,o,i)==h;)e++,n++;for(n=r-1;this.getBoardAtPos(n,o,i)==h;)e++,n--;if(5==e)return!0;e=0;for(var u=o;this.getBoardAtPos(r,u,i)==h;)e++,u++;for(u=o-1;this.getBoardAtPos(r,u,i)==h;)e++,u--;if(5==e)return!0;for(u=r,n=o,e=0;this.getBoardAtPos(u,n,i)==h;)e++,u++,n++;for(u=r-1,n=o-1;this.getBoardAtPos(u,n,i)==h;)e++,u--,n--;if(5==e)return!0;for(u=r,n=o,e=0;this.getBoardAtPos(u,n,i)==h;)e++,u++,n--;for(u=r-1,n=o+1;this.getBoardAtPos(u,n,i)==h;)e++,u--,n++;return e>=5},o.resetSeedList=function(){this.seedList=[]},o.updateSeedByTurn=function(){for(var t=0;t<this.seedList.length;t++){var i=this.seedList[t];this.turn%2==0&&"O"==i.owner&&(i.livedTurn+=1),this.turn%2==1&&"X"==i.owner&&(i.livedTurn+=1),i.livedTurn>=h.seedGrownTurn&&(this.chessboard[i.pos.x][i.pos.y]=i.owner,this.checkWin(i.pos,this.chessboard)&&c.emit(f.END_GAME,this.turn))}this.seedList=this.seedList.filter((function(t){return t.livedTurn<h.seedGrownTurn}))},o.addRemoveSkillPos=function(t,i){var s={cellNum:t,skillOrder:i};this.removeSkillList.push(s)},o.useSeed=function(){this.toggleSkill(u.SEED),this.showPlaceHolder(a.EMPTY_CELLS)},o.setSeedAt=function(t){if(""!=this.chessboard[t.x][t.y])return!1;this.chessboard[t.x][t.y]=l.SEED;var i={pos:t,owner:this.turn%2==0?"O":"X",livedTurn:1};return this.seedList.push(i),!0},o.removeSeedAt=function(t){this.seedList=this.seedList.filter((function(i){return i.pos.x!=t.x&&i.pos.y!=t.y}))},o.findSeedAt=function(t){return this.seedList.find((function(i){return i.pos.x==t.x&&i.pos.y==t.y}))},o.removeSeed=function(t){for(var i=0;i<t.length;i++)this.chessboard[t[i].pos.x][t[i].pos.y]=""},o.useBomb=function(){this.toggleSkill(u.BOMB),this.showPlaceHolder(this.turn%2==0?a.X_CELLS:a.O_CELLS)},o.setBombAt=function(t){if(this.chessboard[t.x][t.y]!=(this.turn%2==0?"X":"O"))return!1;var i={pos:t,owner:this.turn%2==0?"O":"X",existTurn:1};return this.bombList.push(i),!0},o.updateBombByTurn=function(){for(var t=0;t<this.bombList.length;t++)if(this.bombList[t].existTurn+=1,this.bombList[t].existTurn>h.bombExplodeTurn){var i=this.bombList[t].pos;this.chessboard[i.x][i.y]=""}var s=this.bombList.filter((function(t){return t.existTurn>h.bombExplodeTurn}));this.bombList=this.bombList.filter((function(t){return t.existTurn<=h.bombExplodeTurn})),s.length>0&&c.emit(f.REMOVE_BOMB,s)},o.showPlaceHolder=function(t){c.emit(f.CLEAR_PLACEHOLDER,this.curPlaceholder),this.curPlaceholder=this.getPlaceholder(t),c.emit(f.UPDATE_PLACEHODLER,this.curPlaceholder)},o.getPlaceholder=function(t,i){var s=[];if(t==a.SIZE_FIVE)for(var e=i.y-2;e<=i.y+2;e++)for(var r=i.x-2;r<=i.x+2;r++)if(!(r<0||e<0||r>=this.sizeChess||e>=this.sizeChess)){var o=new n(r,e);s.push(o)}if(t==a.EMPTY_CELLS)for(var h=0;h<this.sizeChess;h++)for(var u=0;u<this.sizeChess;u++)if(""==this.chessboard[h][u]){var l=new n(h,u);s.push(l)}if(t==a.O_CELLS)for(var c=0;c<this.sizeChess;c++)for(var f=0;f<this.sizeChess;f++)if("O"==this.chessboard[c][f]){var d=new n(c,f);s.push(d)}if(t==a.X_CELLS)for(var g=0;g<this.sizeChess;g++)for(var T=0;T<this.sizeChess;T++)if("X"==this.chessboard[g][T]){var E=new n(g,T);s.push(E)}return s},o.useRain=function(){this.toggleSkill(u.RAIN)},o.rainInRegion=function(t){var i=this.getRect(t),s=this.turn%2==0?"O":"X",e=this.bombList.filter((function(t){return t.owner!=s&&i.contains(t.pos)}));e.length>0&&c.emit(f.REMOVE_BOMB,e);var n=this.seedList.filter((function(t){return t.owner!=s&&i.contains(t.pos)}));this.removeSeed(n),this.seedList=this.seedList.filter((function(t){return t.owner==s||!i.contains(t.pos)})),this.bombList=this.bombList.filter((function(t){return t.owner==s||!i.contains(t.pos)}));var r=this.bombList.filter((function(t){return t.owner!=s&&i.contains(t.pos)}));if(r.length>0){c.emit(f.REMOVE_THORN,r);for(var o=0;o<r.length;o++)this.chessboard[r[o].pos.x][r[o].pos.y]}this.thornList=this.thornList.filter((function(t){return t.owner==s||!i.contains(t.pos)}))},o.getRect=function(t){for(var i=new n(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),s=new n(Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER),e=0;e<t.length;e++)t[e].x<i.x&&(i.x=t[e].x),t[e].y<i.y&&(i.y=t[e].y),t[e].x>s.x&&(s.x=t[e].x),t[e].y>s.y&&(s.y=t[e].y);return new r(i.x,i.y,Math.abs(s.x-i.x),Math.abs(s.y-i.y))},o.useQuake=function(){this.toggleSkill(u.QUAKE),this.destroyChessman()},o.destroyChessman=function(){for(var t=h.quakeNumEachSide,i=h.quakeNumEachSide,s=[],e=0;e<this.bombList.length;e++){var r=this.bombList[e];if("O"==r.owner&&t>0){var o=this.bombList[e].pos;this.chessboard[o.x][o.y]="",s.push(r),t-=1}if("X"==r.owner&&i>0){var u=this.bombList[e].pos;this.chessboard[u.x][u.y]="",s.push(r),i-=1}}if(c.emit(f.REMOVE_BOMB,s),this.bombList=this.bombList.filter((function(t){return-1==s.indexOf(t)})),t>0||i>0){for(var a=[],l=[],d=0;d<this.sizeChess;d++)for(var g=0;g<this.sizeChess;g++)"X"==this.chessboard[d][g]&&a.push(new n(d,g)),"O"==this.chessboard[d][g]&&l.push(new n(d,g));for(;t>0&&a.length>0;){var T=Math.floor(Math.random()*a.length);this.chessboard[a[T].x][a[T].y]="",a.splice(T,1),t-=1}for(;i>0&&l.length>0;){var E=Math.floor(Math.random()*l.length);this.chessboard[l[E].x][l[E].y]="",l.splice(E,1),i-=1}}c.emit(f.UPDATE_BOARD)},o.useTime=function(){this.toggleSkill(u.TIME),this.turn%2!=0?this.oTurnReduceTime+=h.timeSkillTurnNum:this.xTurnReduceTime+=h.timeSkillTurnNum},o.useBlockage=function(){this.toggleSkill(u.BLOCKAGE),this.setBlock(),c.emit(f.UPDATE_BOARD),c.emit(f.UPDATE_BLOCK_SHOW)},o.setBlock=function(){for(var t=this.getBlockPos(),i=0;i<t.length;i++){var s=t[i],e={pos:t[i].clone(),owner:this.turn%2==0?"O":"X",existTurn:1};this.blockList.push(e),this.chessboard[s.x][s.y]=l.BLOCK}},o.getBlockPos=function(){var t=[];if(0==this.turn)for(var i=0;i<h.numBlockInBlokageSkill;i++){var s=Math.floor(Math.random()*this.sizeChess),e=Math.floor(Math.random()*this.sizeChess);t.push(new n(s,e))}else t=this.getBlockPosAround();return t},o.getBlockPosAround=function(){for(var t=[],i=h.numBlockInBlokageSkill,s=this.generateMove(this.chessboard),e=this.turn%2==0?"X":"O",n=[],r=0;r<s.length;r++)this.isNearTarget(e,s[r])&&n.push(s[r]);if(n.length>i)for(var o=function(){var i=Math.floor(Math.random()*n.length);-1==t.findIndex((function(t){return t.x==n[i].x&&t.y==n[i].y}))&&t.push(n[i].clone())};t.length<i;)o();if(n.length==i&&(t=n),n.length<i)for(var u=i-n.length,a=function(){var i=Math.floor(Math.random()*s.length);-1==t.findIndex((function(t){return t.x==s[i].x&&t.y==s[i].y}))&&t.push(s[i].clone())};t.length<u;)a();return t},o.generateMove=function(t){for(var i=[],s=this.sizeChess,e=0;e<s;e++)for(var r=0;r<s;r++)if(""==t[e][r]){if(e>0){if(r>0&&(""!=t[e-1][r-1]||""!=t[e][r-1])){var o=new n(e,r);i.push(o);continue}if(r<s-1&&(""!=t[e-1][r+1]||""!=t[e][r+1])){var h=new n(e,r);i.push(h);continue}if(""!=t[e-1][r]){var u=new n(e,r);i.push(u);continue}}if(e<s-1&&r>0){if(""!=t[e+1][r-1]||""!=t[e][r-1]){var a=new n(e,r);i.push(a);continue}if(r<s-1&&(t[e+1][r+1]||""!=t[e][r+1])){var l=new n(e,r);i.push(l);continue}if(""!=t[e+1][r]){var c=new n(e,r);i.push(c);continue}}}return i},o.isNearTarget=function(t,i){for(var s=i.x-1;s<=i.x+1;s++)for(var e=i.y-1;e<=i.y+1;e++)if(!(s<0||s>=this.sizeChess||e<0||e>=this.sizeChess)&&this.chessboard[s][e]==t)return!0;return!1},o.updateBlockByTurn=function(){for(var t=0;t<this.blockList.length;t++){var i=this.blockList[t];if(i.existTurn+=1,i.existTurn>h.blockExistTurn){var s=i.pos;this.chessboard[s.x][s.y]=""}}this.blockList=this.blockList.filter((function(t){return t.existTurn<=h.blockExistTurn}))},o.useFrozone=function(){this.toggleSkill(u.FROZONE),this.showPlaceHolder(this.turn%2==0?a.X_CELLS:a.O_CELLS)},o.setIceAt=function(t){var i=this.chessboard[t.x][t.y];if(i!=(this.turn%2==0?"X":"O"))return!1;var s={pos:t,owner:this.turn%2==0?"O":"X",existTurn:1};return this.chessboard[t.x][t.y]=i+l.ICE,this.iceList.push(s),!0},o.updateIceByTurn=function(){for(var t=0;t<this.iceList.length;t++)if(this.iceList[t].existTurn+=1,this.iceList[t].existTurn>h.iceExistTurn){var i=this.iceList[t].pos;this.chessboard[i.x][i.y]=this.chessboard[i.x][i.y].replace(l.ICE,"")}var s=this.iceList.filter((function(t){return t.existTurn>h.iceExistTurn}));this.iceList=this.iceList.filter((function(t){return t.existTurn<=h.iceExistTurn})),s.length>0&&c.emit(f.REMOVE_ICE,s)},o.useThorn=function(){this.toggleSkill(u.THORN_BALL),this.showPlaceHolder(a.EMPTY_CELLS)},o.setThornAt=function(t){if(""!=this.chessboard[t.x][t.y])return!1;this.chessboard[t.x][t.y]=l.THORN;var i={pos:t,owner:this.turn%2==0?"O":"X",existTurn:1};return this.thornList.push(i),!0},o.updateThornByTurn=function(){if(0!=this.thornList.length){for(var t=0;t<this.thornList.length;t++){var i=this.thornList[t];if(i.existTurn+=1,i.existTurn<=h.thornExistTurn){var s=this.getNextThornMove(i).clone();this.chessboard[i.pos.x][i.pos.y]="",i.pos=s.clone(),this.chessboard[s.x][s.y]=l.THORN}else this.chessboard[i.pos.x][i.pos.y]=""}var e=this.thornList.filter((function(t){return t.existTurn>h.thornExistTurn}));this.thornList=this.thornList.filter((function(t){return t.existTurn<=h.thornExistTurn})),e.length>0&&c.emit(f.REMOVE_THORN,e)}},o.getNextThornMove=function(t){var i=this.getThornMoveableList(t.pos);return this.calculateNextMove(t,i)},o.getThornMoveableList=function(t){for(var i=[],s=t.x-5;s<=t.x+5;s++)for(var e=t.y-5;e<=t.y+5;e++)s<0||s>=this.sizeChess||e<0||e>=this.sizeChess||s==t.x&&e==t.y||i.push(new n(s,e));return i},o.calculateNextMove=function(t,i){for(var s,e=[],n=[],r=[],o=t.existTurn<=2,u=0;u<i.length;u++){var a=i[u],c=this.chessboard[a.x][a.y];""==c?e.push(a.clone()):c!=t.owner&&""!=c?n.push(a.clone()):c==l.BLOCK&&r.push(a.clone())}if(o&&e.length>0){s=e[Math.floor(Math.random()*e.length)].clone()}else{var f,d=e.length>0?1:0,g=n.length>0?1:0,T=r.length>0?1:0,E=g*h.thornMoveRate[0],m=T*h.thornMoveRate[1],v=E+m+d*h.thornMoveRate[2],L=Math.random()*v;s=(f=L<E?n:L>=E&&L<E+m?r:e)[Math.floor(Math.random()*f.length)].clone()}return s},o.useDisguise=function(){this.toggleSkill(u.DISGUISE),this.startDisguise(),c.emit(f.UPDATE_DISGUISE_SHOW,this.turn%2==0?"O":"X")},o.startDisguise=function(){var t=this,i=this.turn%2==0?"O":"X",s=this.getPosHasValue(i);if(0!=s.length)if(s.length<=h.disguiseNum){if(0==this.disguiseList.length)for(var e=0;e<s.length;e++){var r={pos:new n(s[e].x,s[e].y),owner:i,existTurn:1};this.disguiseList.push(r)}else for(var o=function(e){if(-1!=t.disguiseList.findIndex((function(t){return t.pos.x==s[e].x&&t.pos.y==s[e].y}))){t.disguiseList.find((function(t){return t.pos.x==s[e].x&&t.pos.y==s[e].y})).existTurn=1}else{var r={pos:new n(s[e].x,s[e].y),owner:i,existTurn:1};t.disguiseList.push(r)}},u=0;u<s.length;u++)o(u);c.emit(f.UPDATE_BOARD)}else if(s.length-this.disguiseList.length>=h.disguiseNum)if(s.length-this.disguiseList.length==h.disguiseNum)for(var a=function(e){if(-1==t.disguiseList.findIndex((function(t){return t.pos.x==s[e].x&&t.pos.x==s[e].y}))){var r={pos:new n(s[e].x,s[e].y),owner:i,existTurn:1};t.disguiseList.push(r)}},l=0;l<s.length;l++)a(l);else{var d=0;if((s=s.filter((function(i){return-1==t.disguiseList.findIndex((function(t){return t.pos.x==i.x&&t.pos.y==i.y}))}))).length<=h.disguiseNum){for(var g=0;g<s.length;g++){var T={pos:new n(s[g].x,s[g].y),owner:i,existTurn:1};this.disguiseList.push(T)}return}for(var E=function(){var e=Math.floor(Math.random()*s.length),r=s[e];if(-1==t.disguiseList.findIndex((function(t){return t.pos.x==r.x&&t.pos.y==r.y}))){var o={pos:new n(r.x,r.y),owner:i,existTurn:1};t.disguiseList.push(o),d+=1}};d<h.disguiseNum;)E()}else for(var m=function(e){if(-1==t.disguiseList.findIndex((function(t){return t.pos.x==s[e].x&&t.pos.y==s[e].y}))){var r={pos:new n(s[e].x,s[e].y),owner:i,existTurn:1};t.disguiseList.push(r)}},v=0;v<s.length;v++)m(v);else c.emit(f.SHOW_TOAST,"You must have at least 1 chessman to disguise")},o.getPosHasValue=function(t){for(var i=[],s=0;s<this.sizeChess;s++)for(var e=0;e<this.sizeChess;e++)this.chessboard[s][e]==t&&i.push(new n(s,e));return i},o.updateDisguiseByTurn=function(){if(0!=this.disguiseList.length){for(var t=0;t<this.disguiseList.length;t++){this.disguiseList[t].existTurn+=1}var i=this.disguiseList.filter((function(t){return t.existTurn>h.disguiseExistTurn}));c.emit(f.REMOVE_DISGUISE,i),this.disguiseList=this.disguiseList.filter((function(t){return t.existTurn<=h.disguiseExistTurn}))}},o.startPlayWithBot=function(){this.isPlayWithBot=!0},o.onInBotTurn=function(){this.blockUserAction(),this.botUseSkill()},o.blockUserAction=function(){},o.botUseSkill=function(){},s(e,null,[{key:"_intance",get:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(o)).instance=null,e._RF.pop()}}}));

System.register("chunks:///_virtual/MatchingScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventMgr.ts","./GameManager.ts","./InGameManager.ts","./SoundManager.ts","./UserManager.ts","./WebSocketHandler.ts","./Define.ts","./ScreenBase.ts","./DefineMatchLogin.ts"],(function(e){var n,t,i,a,o,c,l,r,s,u,h,f,d,g,p,y,M,m,b,S,P,v;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){o=e.cclegacy,c=e._decorator,l=e.Node,r=e.Button,s=e.Label},function(e){u=e.default,h=e.EventName},function(e){f=e.GameManager},function(e){d=e.InGameManager},function(e){g=e.SoundManager,p=e.SoundName},function(e){y=e.UserManager},function(e){M=e.WebSocketHandler},function(e){m=e.ClassicMode,b=e.default},function(e){S=e.ScreenBase},function(e){P=e.RoomType,v=e.RoomMode}],execute:function(){var k,I,C,T,L,B,N,w,A,z,E,R,O,_,D,F,H,K,U,q,G,J,x,Q,V,Y,W,j,X;o._RF.push({},"a3a5aqYXrpLvpbtsPqzJL00","MatchingScreen",void 0);var Z=c.ccclass,$=c.property;e("MatchingScreen",(k=Z("MatchingScreen"),I=$(l),C=$(r),T=$(r),L=$(l),B=$(r),N=$(r),w=$(l),A=$(l),z=$(s),E=$(l),R=$(s),O=$(r),_=$(s),k((H=n((F=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),c=0;c<t;c++)o[c]=arguments[c];return n=e.call.apply(e,[this].concat(o))||this,i(n,"startPhase",H,a(n)),i(n,"classicModeBtn",K,a(n)),i(n,"skillModeBtn",U,a(n)),i(n,"classicModeSelectPhase",q,a(n)),i(n,"freeToPlayBtn",G,a(n)),i(n,"quickPlayBtn",J,a(n)),i(n,"matchPhase",x,a(n)),i(n,"findingIndicator",Q,a(n)),i(n,"player1Name",V,a(n)),i(n,"player2",Y,a(n)),i(n,"player2Name",W,a(n)),i(n,"cancelBtn",j,a(n)),i(n,"loadingText",X,a(n)),n}t(n,e);var o=n.prototype;return o.start=function(){this.classicModeBtn.node.on("click",this.onClassicModeClick,this),this.skillModeBtn.node.on("click",this.onSkillModeBtnClick,this),this.cancelBtn.node.on("click",this.onCancelMatchingClick,this),this.freeToPlayBtn.node.on("click",this.onFreeToPlayClick,this),this.quickPlayBtn.node.on("click",this.onQuickPlayClick,this),this.onStart()},o.update=function(e){},o.onEnable=function(){this.startPhase.active=!0,this.matchPhase.active=!1,this.classicModeSelectPhase.active=!1},o.onStart=function(){this.handleCustomEvent()},o.handleCustomEvent=function(){console.log("START CATCH IN MATCH"),u.on(h.ANOTHER_JOIN_ROOM,this.onAnotherJoinRoom,this),u.on(h.UPDATE_SELF_SESSION_ID,this.updateSelfSessionID,this)},o.onClassicModeClick=function(){this.startPhase.active=!1,this.classicModeSelectPhase.active=!0,g.instance.playSound(p.BIP)},o.onFreeToPlayClick=function(){d.instance.setClassicMode(m.FREE_TO_PLAY),this.goMatching(),g.instance.playSound(p.START)},o.goMatching=function(){f.instance.showLoadingOverlay(),d.instance.setRoomType(P.NORMAL);var e=this.getMatchingInfo(P.NORMAL);M.instance.connect(e)&&(f.instance.hideLoadingOverlay(),this.onMatching())},o.getMatchingInfo=function(e){var n=y.instance.userProfile,t=[];return e==P.SKILL&&(t=b.selfSkills),{roomType:e,roomMode:v.PVP,address:n.wallets.tomo.publicKey,avatar:"",username:n.tgUser.userName,skillIds:e==P.SKILL?t:[]}},o.onQuickPlayClick=function(){d.instance.setClassicMode(m.QUICK_PLAY),this.goMatching()},o.onSkillModeBtnClick=function(){f.instance.showLoadingOverlay(),d.instance.setRoomType(P.SKILL);var e=this.getMatchingInfo(P.SKILL);M.instance.connect(e)&&(f.instance.hideLoadingOverlay(),this.onMatching())},o.onMatching=function(){this.startPhase.active=!1,this.classicModeSelectPhase.active=!1,this.matchPhase.active=!0,this.findingIndicator.active=!0,this.player2.active=!1},o.onCancelMatchingClick=function(){this.startPhase.active=!0,this.matchPhase.active=!1,d.instance.leaveRoom()},o.onFoundPlayer2=function(){this.player2.active=!0,this.findingIndicator.active=!1,this.loadingText.node.active=!0},o.onAnotherJoinRoom=function(e){var n=this;console.log("UPDATE JOIN : ",e),this.onFoundPlayer2(),this.player2Name.string=e.toString(),this.scheduleOnce((function(){n.loadIngameScene()}),2)},o.updateSelfSessionID=function(e){console.log("HAVE EVEN"),this.player1Name.string=e},o.loadIngameScene=function(){u.emit(h.MATCH_MAKING_SUCCESS)},n}(S)).prototype,"startPhase",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=n(F.prototype,"classicModeBtn",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=n(F.prototype,"skillModeBtn",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=n(F.prototype,"classicModeSelectPhase",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=n(F.prototype,"freeToPlayBtn",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=n(F.prototype,"quickPlayBtn",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=n(F.prototype,"matchPhase",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=n(F.prototype,"findingIndicator",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=n(F.prototype,"player1Name",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=n(F.prototype,"player2",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=n(F.prototype,"player2Name",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=n(F.prototype,"cancelBtn",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=n(F.prototype,"loadingText",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=F))||D));o._RF.pop()}}}));

System.register("chunks:///_virtual/MoveResponse.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"22ecaZLpAdNeI0Bx2PYiwm+","MoveResponse",void 0);e("MoveStatus",function(e){return e[e.FAIL=0]="FAIL",e[e.SUCCESS=1]="SUCCESS",e}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/NetworkManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var e,t,r,o;return{setters:[function(n){e=n.inheritsLoose},function(n){t=n.cclegacy,r=n._decorator,o=n.Component}],execute:function(){var c,a;t._RF.push({},"0578bgr7ttM45v/70t+Stvq","NetworkManager",void 0);var i=r.ccclass;r.property,n("NetworkManager",i("NetworkManager")(((a=function(n){function t(){return n.apply(this,arguments)||this}e(t,n),t.instance=function(){return t._instance||(t._instance=new t),t._instance};var r=t.prototype;return r.connectToServer=function(){},r.sendMessage=function(n,e){},t}(o))._instance=void 0,c=a))||c);t._RF.pop()}}}));

System.register("chunks:///_virtual/PopupManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventMgr.ts","./BasePopup.ts","./ErrorPopup.ts","./Define.ts"],(function(o){var n,t,e,p,r,i,a,u,c,s,l,f,h,P,d,v;return{setters:[function(o){n=o.applyDecoratedDescriptor,t=o.inheritsLoose,e=o.initializerDefineProperty,p=o.assertThisInitialized},function(o){r=o.cclegacy,i=o._decorator,a=o.Node,u=o.resources,c=o.Prefab,s=o.instantiate,l=o.Component},function(o){f=o.default,h=o.EventName},function(o){P=o.BasePopup},function(o){d=o.ErrorPopup},function(o){v=o.PopupName}],execute:function(){var g,y,C,b,m;r._RF.push({},"21bc63LMjhIaZ5z93ifqOiV","PopupManager",void 0);var E=i.ccclass,M=i.property;o("PopupManager",(g=E("PopupManager"),y=M(a),g((m=n((b=function(o){function n(){for(var n,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return n=o.call.apply(o,[this].concat(r))||this,e(n,"popupContainer",m,p(n)),n}t(n,o);var r=n.prototype;return r.start=function(){this.loadPopup(),f.on(h.SHOW_POPUP,this.onShowPopup,this)},r.loadPopup=function(){var o=this;u.loadDir("prefabs/popups",c,(function(n,t){n?console.error("Fail to load prefab popups"):(t.forEach((function(n){var t=s(n);o.popupContainer.addChild(t)})),o.deactiveAllPopup())}))},r.update=function(o){},r.onShowPopup=function(o,n){switch(this.deactiveAllPopup(),o){case v.ERROR:var t=this.popupContainer.children.find((function(n){return n.getComponent(P).type==o}));t&&(t.active=!0,t.getComponent(d).setup(n))}},r.deactiveAllPopup=function(){this.popupContainer.children.forEach((function(o){return o.active=!1}))},n}(l)).prototype,"popupContainer",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=b))||C));r._RF.pop()}}}));

System.register("chunks:///_virtual/ScreenBase.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,i,o,c,a,s;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,c=e._decorator,a=e.Enum,s=e.Component}],execute:function(){var u,p,l,f,y;o._RF.push({},"e6a1fhKV0VFIrpgDNbZXIy+","ScreenBase",void 0);var N=c.ccclass,h=c.property,d=e("ScreenType",function(e){return e[e.NONE=0]="NONE",e[e.LOGIN=1]="LOGIN",e[e.MATCHING=2]="MATCHING",e[e.IN_GAME=3]="IN_GAME",e}({}));e("ScreenBase",(u=N("ScreenBase"),p=h({type:a(d)}),u((y=t((f=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return t=e.call.apply(e,[this].concat(o))||this,r(t,"type",y,i(t)),t}n(t,e);var o=t.prototype;return o.start=function(){},o.update=function(e){},o.show=function(){this.node.active=!0},o.hide=function(){this.node.active=!1},t}(s)).prototype,"type",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return d.NONE}}),l=f))||l));o._RF.pop()}}}));

System.register("chunks:///_virtual/ScreenManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventMgr.ts","./ScreenBase.ts"],(function(e){var n,t,r,i,c,s,o,a,u,l,p,h;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,c=e.createClass},function(e){s=e.cclegacy,o=e._decorator,a=e.Component},function(e){u=e.default,l=e.EventName},function(e){p=e.ScreenBase,h=e.ScreenType}],execute:function(){var f,g,d,v,y,S;s._RF.push({},"4bdb9WbgpRBNrfBuuplag49","ScreenManager",void 0);var _=o.ccclass,b=o.property;e("ScreenManager",(f=_("ScreenManager"),g=b(p),f(((S=function(e){function n(){for(var n,t=arguments.length,c=new Array(t),s=0;s<t;s++)c[s]=arguments[s];return n=e.call.apply(e,[this].concat(c))||this,r(n,"screens",y,i(n)),n.curScr=null,n}t(n,e);var s=n.prototype;return s.onLoad=function(){null==n._instance?n._instance=this:this.node.destroy()},s.start=function(){u.on(l.LOGIN,this.onLogIn,this)},s.update=function(e){},s.showScreen=function(e){var n;this.deactiveAllScreen();var t=this.screens.find((function(n){return n.getComponent(p).type==e}));this.curScr&&(null==(n=this.curScr)?void 0:n.type)==t.type||t.show()},s.deactiveAllScreen=function(){for(var e=0;e<this.screens.length;e++)this.screens[e].hide()},s.onLogIn=function(){this.showScreen(h.LOGIN)},c(n,null,[{key:"instance",get:function(){return this._instance||console.error("InGameManger is not initialized!"),this._instance}}]),n}(a))._instance=null,y=n((v=S).prototype,"screens",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),d=v))||d));s._RF.pop()}}}));

System.register("chunks:///_virtual/SkillButton.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Define.ts","./EventMgr.ts"],(function(t){var e,i,n,l,r,o,s,u,c,a,p,f,k;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,l=t.assertThisInitialized},function(t){r=t.cclegacy,o=t._decorator,s=t.Sprite,u=t.SpriteFrame,c=t.Component},function(t){a=t.SkillId,p=t.PetImgBySkill},function(t){f=t.default,k=t.EventName}],execute:function(){var g,m,S,h,y,d,v;r._RF.push({},"73bd8xAC89G9KyQga0vyEvE","SkillButton",void 0);var I=o.ccclass,b=o.property;t("SkillButton",(g=I("SkillButton"),m=b(s),S=b(u),g((d=e((y=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,n(e,"skillPetImg",d,l(e)),n(e,"petImgs",v,l(e)),e.skill=a.NONE,e}i(e,t);var r=e.prototype;return r.start=function(){this.node.on("click",this.onSelectSkill,this)},r.update=function(t){},r.setup=function(t){this.skill=t;var e;e=p[Object.keys(p).find((function(e){return e==t}))],console.log("IMG NAME: ",e),this.skillPetImg.spriteFrame=this.petImgs.find((function(t){return t.name==e}))},r.onSelectSkill=function(){f.emit(k.CHANGE_SELECT_SKILL,this.skill)},e}(c)).prototype,"skillPetImg",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=e(y.prototype,"petImgs",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),h=y))||h));r._RF.pop()}}}));

System.register("chunks:///_virtual/SkillInfo.ts",["cc","./Define.ts"],(function(e){var t,n,i,l;return{setters:[function(e){t=e.cclegacy},function(e){n=e.ElementType,i=e.SkillId,l=e.SkillType}],execute:function(){t._RF.push({},"cbe88JXkp5DTZfPcclVRFR5","SkillInfo",void 0);e("SkillInfo",[{name:"Time Manipulation",elementType:n.FIRE,skillId:i.TIME,skillType:l.PLAYER_EFFECT,description:"Reduces opponent's play time by 50% for 5 turns, limiting the opponent to only 50% of their usual play time per turn.",attributes:{castRate:1,isAoeSkill:!1,existTurn:5,timeReductionPercentage:.5}},{name:"Cleansing rain",elementType:n.WATER,skillId:i.RAIN,skillType:l.BOARD_EFFECT,description:"Clear all skill objects on a 5x5 area.",attributes:{castRate:1,isAoeSkill:!0,aoeRange:5,existTurn:0}},{name:"Thorn ball",elementType:n.NATURE,skillId:i.THORN_BALL,skillType:l.SPAWN,description:"Creates a thorn ball that randomly moves to a new cell each turn and can destroy opponent's pieces if it lands on them.",attributes:{castRate:1,isAoeSkill:!1,existTurn:5,jumpRange:5,targetJumpRate:{opponent:.25,blockage:.5,empty:.25}}},{name:"Sprouting",elementType:n.NATURE,skillId:i.SEED,skillType:l.SPAWN,description:"Marks a cell to grow into a player's piece after 3 turns.",attributes:{castRate:1,isAoeSkill:!1,existTurn:6}},{name:"Timing bomb",elementType:n.FIRE,skillId:i.BOMB,skillType:l.SPAWN,description:"Place a bomb on an opponent's chessman. Explode in 3 turns",attributes:{castRate:1,isAoeSkill:!1,existTurn:5}}]);t._RF.pop()}}}));

System.register("chunks:///_virtual/SkillObject.ts",["cc"],(function(){var c;return{setters:[function(t){c=t.cclegacy}],execute:function(){c._RF.push({},"22112XXccFMxbaJ/qohSk3S","SkillObject",void 0),c._RF.pop()}}}));

System.register("chunks:///_virtual/SkillRepository.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"a5f58pqiDJNCoYRd/5dGikr","SkillRepository",void 0);var e=t("SortType",function(t){return t[t.NAME=0]="NAME",t[t.CAST_RATE=1]="CAST_RATE",t[t.AOE_RANGE=2]="AOE_RANGE",t[t.EXIST_TURN=3]="EXIST_TURN",t}({}));t("SkillRepository",function(){function t(t){var i=this;this.gameSkillList=new Map,t&&t.forEach((function(t,e){i.gameSkillList.set(t,e)}))}var i=t.prototype;return i.searchSkill=function(t){return this.gameSkillList.get(t)},i.insertSkill=function(t,i){var e;null==(e=this.gameSkillList)||e.set(t,i)},i.sortSkill=function(t){switch(t){case e.CAST_RATE:this.gameSkillList=new Map([].concat(this.gameSkillList.entries()).sort((function(t,i){return t[1].attribute.castRate-i[1].attribute.castRate})));break;case e.NAME:this.gameSkillList=new Map([].concat(this.gameSkillList.entries()).sort((function(t,i){return t[1].name.localeCompare(i[1].name)})));break;case e.AOE_RANGE:this.gameSkillList=new Map([].concat(this.gameSkillList.entries()).sort((function(t,i){return t[1].attribute.aoeRange-i[1].attribute.aoeRange})));break;case e.EXIST_TURN:this.gameSkillList=new Map([].concat(this.gameSkillList.entries()).sort((function(t,i){return t[1].attribute.existTurn-i[1].attribute.existTurn})))}},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/SoundManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var o,t,i,e,r,u,a,c,s,d,l,p,h;return{setters:[function(n){o=n.applyDecoratedDescriptor,t=n.inheritsLoose,i=n.initializerDefineProperty,e=n.assertThisInitialized,r=n.createClass},function(n){u=n.cclegacy,a=n._decorator,c=n.CCBoolean,s=n.director,d=n.AudioSource,l=n.resources,p=n.AudioClip,h=n.Component}],execute:function(){var S,f,y,g,m,v;u._RF.push({},"e00595pnKdMRrNCiBZhOoL6","SoundManager",void 0);var C=a.ccclass,M=a.property,_=n("SoundName",function(n){return n.BIP="bip",n.START="start",n.BACKGROUND="background",n}({}));n("SoundManager",(S=C("SoundManager"),f=M(c),S(((v=function(n){function o(){for(var o,t=arguments.length,r=new Array(t),u=0;u<t;u++)r[u]=arguments[u];return o=n.call.apply(n,[this].concat(r))||this,i(o,"mute",m,e(o)),o.audioSource=null,o.clips=[],o}t(o,n);var u=o.prototype;return u.onLoad=function(){null==o._instance?(o._instance=this,s.addPersistRootNode(this.node)):this.node.destroy()},u.start=function(){this.audioSource=this.getComponent(d),this.audioSource||(this.audioSource=this.addComponent(d)),this.loadSound(),this.muteSound()},u.update=function(n){},u.loadSound=function(){var n=this;l.loadDir("sounds",p,(function(o,t){o?console.error("FAIL TO LOAD SOUND: ",o):(n.clips=t,n.playBackgroundMusic())}))},u.playBackgroundMusic=function(){this.playSound(_.BACKGROUND,!0)},u.playSound=function(n,o){void 0===o&&(o=!1);var t=this.clips.find((function(o){return o.name==n}));t&&(o?(this.audioSource.loop=!0,this.audioSource.clip=t,this.audioSource.play()):this.audioSource.playOneShot(t))},u.muteSound=function(){this.mute&&(this.audioSource.volume=0)},r(o,null,[{key:"instance",get:function(){return this._instance||console.error("InGameManger is not initialized!"),this._instance}}]),o}(h))._instance=null,m=o((g=v).prototype,"mute",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=g))||y));u._RF.pop()}}}));

System.register("chunks:///_virtual/SpawnObject.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,c,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,c=t._decorator,r=t.Component}],execute:function(){var o;e._RF.push({},"9ad69bPqPNGLJjN7ut6eqS5","SpawnObject",void 0);var u=c.ccclass;c.property,t("SpawnObject",u("SpawnObject")(o=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var c=e.prototype;return c.start=function(){},c.update=function(t){},e}(r))||o);e._RF.pop()}}}));

System.register("chunks:///_virtual/ToastHolder.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventMgr.ts"],(function(t){var e,o,n,r,i,a,s,l,c,u,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){i=t.cclegacy,a=t._decorator,s=t.Node,l=t.Label,c=t.Component},function(t){u=t.default,p=t.EventName}],execute:function(){var f,d,h,v,T,y,H;i._RF.push({},"1e006XxWIJL5oPFbeB1yNxe","ToastHolder",void 0);var b=a.ccclass,g=a.property;t("ToastHolder",(f=b("ToastHolder"),d=g(s),h=g(l),f((y=e((T=function(t){function e(){for(var e,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i))||this,n(e,"toastHolder",y,r(e)),n(e,"toastContentText",H,r(e)),e}o(e,t);var i=e.prototype;return i.start=function(){u.on(p.SHOW_TOAST,this.showToast,this)},i.update=function(t){},i.showToast=function(t){var e=this;this.toastHolder.active=!0,this.toastContentText.string=t,this.scheduleOnce((function(){e.toastHolder.active=!1}),2)},e}(c)).prototype,"toastHolder",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(T.prototype,"toastContentText",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=T))||v));i._RF.pop()}}}));

System.register("chunks:///_virtual/UserManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,r,t,s,c;return{setters:[function(e){n=e.inheritsLoose,r=e.createClass},function(e){t=e.cclegacy,s=e._decorator,c=e.Component}],execute:function(){var o,a;t._RF.push({},"61ce3kmFUhKxKd7wUmSsrV9","UserManager",void 0);var i=s.ccclass;s.property,e("UserManager",i("UserManager")(((a=function(e){function t(){var n;return(n=e.call(this)||this).userProfile=void 0,n}return n(t,e),t.prototype.setProfile=function(){console.log("USER MGR SET PROFILE")},r(t,null,[{key:"instance",get:function(){return t._instance||(t._instance=new t),t._instance}}]),t}(c))._instance=null,o=a))||o);t._RF.pop()}}}));

System.register("chunks:///_virtual/UserProfile.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"023f8ftRHNKJIdL0Z+OFXPz","UserProfile",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/WebSocketHandler.ts",["./rollupPluginModLoBabelHelpers.js","cc","./colyseus-cocos-creator.mjs_cjs=&original=.js","./EventMgr.ts","./Define.ts","./colyseus-cocos-creator.js"],(function(e){var t,n,o,i,r,s,a,c,l,u,h,f,d,p,m,R;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized,r=e.createClass,s=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){c=e.cclegacy,l=e._decorator,u=e.director,h=e.Component},null,function(e){f=e.default,d=e.EventName},function(e){p=e.MessageType,m=e.PopupName},function(e){R=e.default}],execute:function(){var g,S,O,v,y,E,_;c._RF.push({},"f2acfW0Op1FCoo/rHWpKZKI","WebSocketHandler",void 0);var I=l.ccclass,P=l.property;e("WebSocketHandler",I("WebSocketHandler")(((_=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t=e.call.apply(e,[this].concat(r))||this,o(t,"hostname",O,i(t)),o(t,"port",v,i(t)),o(t,"useSSL",y,i(t)),o(t,"roomID",E,i(t)),t.client=void 0,t.room=void 0,t.selfSessionId="",t.roomType=null,t}n(t,e);var c=t.prototype;return c.onLoad=function(){null==t._instance?(t._instance=this,u.addPersistRootNode(this.node)):this.node.destroy()},c.start=function(){var e=this,t=(this.useSSL?"wss":"ws")+"://"+this.hostname+(-1!=[443,80].findIndex((function(t){return t==e.port}))||this.useSSL?"":":"+this.port);console.log("SETTING: ",t),this.client=new R.Client(t)},c.connect=function(){var e=s(a().mark((function e(t){var n,o,i,r,s,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.roomType=t.roomType,e.prev=1,e.next=4,this.client.joinOrCreate(this.roomID,t);case 4:return this.room=e.sent,console.log("SessionID: ",this.room.sessionId),this.selfSessionId=this.room.sessionId,f.emit(d.UPDATE_SELF_SESSION_ID,this.selfSessionId),this.room.onMessage("*",(function(e,t){c.onReceiveMessage(e,t)})),this.room.onStateChange((function(e){c.handleStateChange(e)})),this.room.onLeave((function(e){console.log("onLeave: ",e)})),this.room.state.listen("players",(function(e){console.log("PLAYER ID ",e)})),this.room.state.players.onChange((function(e,t){c.handlePlayerChange(e,t),t!=c.selfSessionId&&(f.emit(d.ANOTHER_JOIN_ROOM,t),console.log("EMIT  player 2"))})),e.abrupt("return",this.room);case 16:return e.prev=16,e.t0=e.catch(1),console.log("ERROR: ",e.t0),null!=(n=e.t0.message)&&n.includes("match-making")?(i={title:"MATCHING ERROR!!!",content:"No available rooms matching the criteria.",leftBtnText:"OK"},f.emit(d.SHOW_POPUP,m.ERROR,i)):null!=(o=e.t0.message)&&o.includes("unauthorized")?(r={title:"MATCHING ERROR!!!",content:"Access denied. Please check your credentials or permissions.",leftBtnText:"OK"},f.emit(d.SHOW_POPUP,m.ERROR,r)):(s={title:"MATCHING ERROR!!!",content:"An unexpected error occurred: "+e.t0.message,leftBtnText:"OK"},f.emit(d.SHOW_POPUP,m.ERROR,s)),e.abrupt("return",null);case 21:case"end":return e.stop()}}),e,this,[[1,16]])})));return function(t){return e.apply(this,arguments)}}(),c.leave=function(){var e;null==(e=this.room)||e.leave()},c.sendMove=function(e){var t;null==(t=this.room)||t.send("NORMAL_MOVE",e)},c.sendSkillMove=function(e){var t;console.log("SKILL MOVE: ",e),null==(t=this.room)||t.send("SKILL_MOVE",e)},c.onReceiveMessage=function(e,t){console.log("receive Message",e," + ",t),this.handleMessage(e,t)},c.handleMessage=function(e,t){switch(e){case p.ERROR:var n={title:"ERROR!!!",content:""+t,leftBtnText:"OK"};f.emit(d.SHOW_POPUP,m.ERROR,n)}},c.handleStateChange=function(e){f.emit(d.ROOM_STATE_CHANGE,e)},c.handlePlayerChange=function(e,t){f.emit(d.PLAYER_STATE_CHANGE,e,t)},r(t,null,[{key:"instance",get:function(){return this._instance||console.error("WebSocketHandler is not initialized!"),this._instance}}]),t}(h))._instance=null,O=t((S=_).prototype,"hostname",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"10.40.0.74"}}),v=t(S.prototype,"port",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3e3}}),y=t(S.prototype,"useSSL",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),E=t(S.prototype,"roomID",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"coin98_caro"}}),g=S))||g);c._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});